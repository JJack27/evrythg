Estimation Theory
Alireza Karimi
Laboratoire d’Automatique, MEC2 397,
email: alireza.karimi@epﬂ.ch

Spring 2013

(Introduction)

Estimation Theory

Spring 2013

1 / 152

Course Objective
Extract information from noisy signals
Parameter Estimation Problem : Given a set of measured data
{x[0], x[1], . . . , x[N − 1]}
which depends on an unknown parameter vector θ, determine an estimator
ˆ
θ = g (x[0], x[1], . . . , x[N − 1])
where g is some function.

Applications : Image processing, communications, biomedicine, system
identiﬁcation, state estimation in control, etc.
(Introduction)

Estimation Theory

Spring 2013

2 / 152

Some Examples
Range estimation : We transmit a pulse that is reﬂected by the aircraft.
An echo is received after τ second. Range θ is estimated from the equation
θ = τ c/2 where c is the light’s speed.
System identiﬁcation : The input of a plant is excited with u and the
output signal y is measured. If we have :
y [k] = G (q −1 , θ)u[k] + n[k]
where n[k] is the measurement noise. The model parameters are estimated
using u[k] and y [k] for k = 1, . . . , N.
DC level in noise : Consider a set of data {x[0], x[1], . . . , x[N − 1]} that
can be modeled as :
x[n] = A + w [n]
where w [n] is some zero mean noise process. A can be estimated using the
measured data set.
(Introduction)

Estimation Theory

Spring 2013

3 / 152

Outline
Classical estimation (θ deterministic)
Minimum Variance Unbiased Estimator (MVU)
Cramer-Rao Lower Bound (CRLB)
Best Linear Unbiased Estimator (BLUE)
Maximum Likelihood Estimator (MLE)
Least Squares Estimator (LSE)
Bayesian estimation (θ stochastic)
Minimum Mean Square Error Estimator (MMSE)
Maximum A Posteriori Estimator (MAP)
Linear MMSE Estimator
Kalman Filter

(Introduction)

Estimation Theory

Spring 2013

4 / 152

References
Main reference :

Fundamentals of Statistical Signal Processing
Estimation Theory
by Steven M. KAY, Prentice-Hall, 1993 (available in Library de La
Fontaine, RLC). We cover Chapters 1 to 14, skipping Chapter 5 and
Chapter 9.

Other references :
Lessons in Estimation Theory for Signal Processing, Communications
and Control. By Jerry M. Mendel, Prentice-Hall, 1995.
Probability, Random Processes and Estimation Theory for Engineers.
By Henry Stark and John W. Woods, Prentice-Hall, 1986.
(Introduction)

Estimation Theory

Spring 2013

5 / 152

Review of Probability and Random Variables

(Probability and Random Variables)

Estimation Theory

Spring 2013

6 / 152

Random Variables
Random Variable : A rule X (·) that assigns to every element of a sample
space Ω a real value is called a RV. So X is not really a variable that varies
randomly but a function whose domain is Ω and whose range is some
subset of the real line.
Example : Consider the experiment of ﬂipping a coin twice. The sample
space (the possible outcomes) is :
Ω = {HH, HT , TH, TT }
We can deﬁne a random variable X such that
X (HH) = 1, X (HT ) = 1.1, X (TH) = 1.6, X (TT ) = 1.8
Random variable X assigns to each event (e.g. E = {HT , TH} ⊂ Ω) a
subset of the real line (in this case B = {1.1, 1.6}).
(Probability and Random Variables)

Estimation Theory

Spring 2013

7 / 152

Probability Distribution Function
For any element ζ in Ω, the event {ζ|X (ζ) ≤ x} is an important event.
The probability of this event
Pr [{ζ|X (ζ) ≤ x}] = PX (x)
is called the probability distribution function of X .
Example : For the random variable deﬁned earlier, we have :
PX (1.5) = Pr [{ζ|X (ζ) ≤ 1.5}] = Pr [{HH, HT }] = 0.5
PX (x) can be computed for all x ∈ R. It is clear that 0 ≤ PX (x) ≤ 1.
Remark :
For the same experiment (throwing a coin twice) we could deﬁne
another random variable that would lead to a diﬀerent PX (x).
In most of engineering problems the sample space is a subset of the
real line so X (ζ) = ζ and PX (x) is a continuous function of x.
(Probability and Random Variables)

Estimation Theory

Spring 2013

8 / 152

Probability Density Function (PDF)
The Probability Density Function, if it exists, is given by :
dPX (x)
dx
When we deal with a single random variable the subscripts are removed :
pX (x) =

p(x) =

dP(x)
dx

Properties :
∞

(i )
−∞

(ii )
(iii )

p(x)dx = P(∞) − P(−∞) = 1

Pr [{ζ|X (ζ) ≤ x}] = Pr [X ≤ x] = P(x) =
Pr [x1 < X ≤ x2 ] =

x2

x
−∞

p(α)d α

p(x)dx
x1

(Probability and Random Variables)

Estimation Theory

Spring 2013

9 / 152

Gaussian Probability Density Function
A random variable is distributed according to a Gaussian or normal
distribution if the PDF is given by :

p(x) = √

1
2πσ 2

e−

(x−µ)2
2σ2

The PDF has two parameters : µ, the mean and σ 2 the variance.
We note X ∼ N (µ, σ 2 ) when the random variable X has a normal
(Gaussian) distribution with the mean µ and the standard deviation σ.
Small σ means small variability (uncertainty) and large σ means large
variability.
Remark : Gaussian distribution is important because according to the
Central Limit Theorem the sum of N independent RVs has a PDF that
converges to a Gaussian distribution when N goes to inﬁnity.
(Probability and Random Variables)

Estimation Theory

Spring 2013

10 / 152

Some other common PDF
1
b−a

a<x <b
otherwise

Uniform (b > a) :

p(x) =

Exponential (µ > 0) :

p(x) =

1
exp(−x/µ)u(x)
µ

Rayleigh (σ > 0) :

p(x) =

−x 2
x
exp( 2 )u(x)
σ2
2σ

Chi-square χ2 :

p(x) =

∞

where Γ(z) =

0

√

1
x n/2−1 exp(− x )
2
2n Γ(n/2)

0

for x > 0
for x < 0

t z−1 e −t dt and u(x) is the unit step function.

0

(Probability and Random Variables)

Estimation Theory

Spring 2013

11 / 152

Joint, Marginal and Conditional PDF
Joint PDF : Consider two random variables X and Y then :
Pr [x1 < X ≤ x2 and y1 < Y ≤ y2 ] =

x2

y2

p(x, y )dxdy
x1

y1

Marginal PDF :
∞

∞

p(x, y )dy

p(x) =

and

−∞

p(y ) =

p(x, y )dx
−∞

Conditional PDF : p(x|y ) is deﬁned as the PDF of X conditioned on
knowing the value of Y .
Bayes’ Formula : Consider two RVs deﬁned on the same probability space
then we have :
p(x, y )
or
p(x|y ) =
p(x, y ) = p(x|y )p(y ) = p(y |x)p(x)
p(y )
(Probability and Random Variables)

Estimation Theory

Spring 2013

12 / 152

Independent Random Variables
Two RVs X and Y are independent if and only if :
p(x, y ) = p(x)p(y )

A direct conclusion is that :
p(x|y ) =

p(x)p(y )
p(x, y )
=
= p(x)
p(y )
p(y )

and

p(y |x) = p(y )

which means conditioning does not change the PDF.
Remark : For a joint Gaussian pdf the contours of constant density is an
ellipse centered at (µx , µy ). For independent X and Y the major (or
minor) axis is parallel to x or y axis.

(Probability and Random Variables)

Estimation Theory

Spring 2013

13 / 152

Expected Value of a Random Variable
The expected value, if it exists, of a random variable X with PDF p(x) is
deﬁned by :
∞

xp(x)dx

E (X ) =
−∞

Some properties of expected value :
E {X + Y } = E {X } + E {Y }
E {aX } = aE {X }
The expected value of Y = g (X ) can be computed by :
∞

g (x)p(x)dx

E (Y ) =
−∞

Conditional expectation : The conditional expectation of X given that a
speciﬁc value of Y has occurred is :
E (X |Y ) =
(Probability and Random Variables)

∞

xp(x|y )dx
−∞

Estimation Theory

Spring 2013

14 / 152

Moments of a Random Variable
The r th moment of X is deﬁned as :
E (X r ) =

∞

x r p(x)dx

−∞

The ﬁrst moment of X is its expected value or the mean (µ = E (X )).
Moments of Gaussian RVs : A Gaussian RV with N (µ, σ 2 ) has
moments of all orders in closed form
E (X )
E (X 2 )
E (X 3 )
E (X 4 )
E (X 5 )
E (X 6 )

(Probability and Random Variables)

=
=
=
=
=
=

µ
µ2 + σ 2
µ3 + 3µσ 2
µ4 + 6µ2 σ 2 + 3σ 4
µ5 + 10µ3 σ 2 + 15µσ 4
µ6 + 15µ4 σ 2 + 45µ2 σ 4 + 15σ 6

Estimation Theory

Spring 2013

15 / 152

Central Moments
The r th central moment of X is deﬁned as :
E [(X − µ)r ] =

∞
−∞

(x − µ)r p(x)dx

The second central moment (variance) is denoted by σ 2 or var(X ).
Central Moments of Gaussian RVs :
E [(X − µ)r ] =

0
if r is odd
σ r (r − 1)!! if r is even

where n!! denotes the double factorial that is the product of every odd
number from n to 1.

(Probability and Random Variables)

Estimation Theory

Spring 2013

16 / 152

Some properties of Gaussian RVs
2
If X ∼ N (µx , σx ) then Z = (X − µx )/σx ∼ N (0, 1).
2
If Z ∼ N (0, 1) then X = σx Z + µx ∼ N (µx , σx ).
2
2
If X ∼ N (µx , σx ) then Z = aX + b ∼ N (aµx + b, a2 σx ).
2
2
If X ∼ N (µx , σx ) and Y ∼ N (µy , σy ) are two independent RVs, then
2
2
aX + bY ∼ N (aµx + bµy , aσx + bσy )

The sum of square of n independent RV with standard normal
distribution N (0, 1) has a χ2 distribution with n degree of freedom.
n
For large value of n, χ2 converges to N (n, 2n).
√n
The Euclidian norm X 2 + Y 2 of two independent RVs with
standard normal distribution has the Rayleigh distribution.

(Probability and Random Variables)

Estimation Theory

Spring 2013

17 / 152

Covariance
For two RVs X and Y , the covariance is deﬁned as
σxy = E [(X − µx )(Y − µy )]
σxy =

∞

∞

−∞

−∞

(x − µx )(y − µy )p(x, y )dxdy

If X and Y are zero mean then σxy = E {XY }.
2
2
var(X + Y ) = σx + σy + 2σxy
2
var(aX ) = a2 σx
Important formula : The relation between the variance and the mean of
X is given by
σ 2 = E [(X − µ)2 ] = E (X 2 ) − 2µE (X ) + µ2
= E (X 2 ) − µ2
The variance is the mean of the square minus the square of the mean.
(Probability and Random Variables)

Estimation Theory

Spring 2013

18 / 152

Independence, Uncorrelatedness and Orthogonality
If σxy = 0, then X and Y are uncorrelated and
E {XY } = E {X }E {Y }
X and Y called orthogonal if E {XY } = 0.

('140502183413')
If X and Y are independent then they are uncorrelated.

p(x, y ) = p(x)p(y ) ⇒ E {XY } = E {X }E {Y }
Uncorrelatedness does not imply the independence. For example, if X
is a normal RV with zero mean and Y = X 2 we have p(y |x) = p(y )
but
σxy = E {XY } − E {X }E {Y } = E {X 3 } − 0 = 0
The correlation only shows the linear dependence between two RV so
is weaker than independence.

('140502183418')
For Jointly Gaussian RVs, independence is equivalent to being uncorrelated.

Estimation Theory

Spring 2013

19 / 152

Random Vectors
Random Vector : is a vector of random variables 1 :
x = [x1 , x2 , . . . , xn ]T
Expectation Vector : µx = E (x) = [E (x1 ), E (x2 ), . . . , E (xn )]T
Covariance Matrix : Cx = E [(x − µx )(x − µx )T ]
Cx is an n × n symmetric matrix which is assumed to be positive
deﬁnite and so invertible.
The elements of this matrix are : [Cx ]ij = E {[xi − E (xi )][xj − E (xj )]}.

('140502183439')
If the random variables are uncorrelated then Cx is a diagonal matrix.

Multivariate Gaussian PDF :
p(x) =

1
1
exp − (x − µx )T C−1 (x − µx )
x
2
(2π)n det(Cx )

1. In some books (including our main reference) there is no distinction between random
variable X and its speciﬁc value x. From now on we adopt the notation of our reference.
(Probability and Random Variables)

Estimation Theory

Spring 2013

20 / 152

Random Processes
Discrete Random Process : x[n] is a sequence of random variables
deﬁned for every integer n.
Mean value : is deﬁned as E (x[n]) = µx [n].
Autocorrelation Function (ACF) : is deﬁned as
rxx [k, n] = E (x[n]x[n + k])
Wide Sense Stationary (WSS) : x[n] is WSS if its mean and its
autocorrelation function (ACF) do not depend on n.
Autocovariance function : is deﬁned as
cxx [k] = E [(x[n] − µx )(x[n + k] − µx )] = rxx [k] − µ2
x
Cross-correlation Function (CCF) : is deﬁned as
rxy [k] = E (x[n]y [n + k])
Cross-covariance function : is deﬁned as
cxy [k] = E [(x[n] − µx )(y [n + k] − µy )] = rxy [k] − µx µy
(Probability and Random Variables)

Estimation Theory

Spring 2013

21 / 152

Discrete White Noise
Some properties of ACF and CCF :
rxx [0] ≥ |rxx [k]|

rxx [k] = rxx [−k]

rxy [k] = ryx [−k]

Power Spectral Density : The Fourier transform of ACF and CCF gives
the Auto-PSD and Cross-PSD :
∞

Pxx (f ) =

rxx [k] exp(−j2πfk)
k=−∞
∞

Pxy (f ) =

rxy [k] exp(−j2πfk)
k=−∞

Discrete White Noise : is a discrete random process with zero mean and
rxx [k] = σ 2 δ[k] where δ[k] is the Kronecker impulse function. The PSD of
white noise becomes Pxx (f ) = σ 2 and is completely ﬂat with frequency.
(Probability and Random Variables)

Estimation Theory

Spring 2013

22 / 152

Introduction and Minimum Variance Unbiased
Estimation

(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

23 / 152

The Mathematical Estimation Problem
Parameter Estimation Problem : Given a set of measured data
x = {x[0], x[1], . . . , x[N − 1]}
which depends on an unknown parameter vector θ, determine an estimator
ˆ
θ = g (x[0], x[1], . . . , x[N − 1])
where g is some function.

The ﬁrst step is to ﬁnd the PDF of data as a
function of θ : p(x; θ)
Example : Consider the problem of DC level in white Gaussian noise with
one observed data x[0] = θ + w [0] where w [0] has the PDF N (0, σ 2 ).
Then the PDF of x[0] is :
p(x[0]; θ) = √
(Minimum Variance Unbiased Estimation)

1
2πσ 2

exp −

Estimation Theory

1
(x[0] − θ)2
2σ 2
Spring 2013

24 / 152

The Mathematical Estimation Problem
Example : Consider a data sequence that can be modeled with a linear
trend in white Gaussian noise
x[n] = A + Bn + w [n]

n = 0, 1, . . . , N − 1

Suppose that w [n] ∼ N (0, σ 2 ) and is uncorrelated with all the other
samples. Letting θ = [A B] and x = [x[0], x[1], . . . , x[N − 1]] the PDF is :
N−1

p(x; θ) =

1
1
p(x[n]; θ) = √
exp − 2
2σ
( 2πσ 2 )N
n=0

N−1

(x[n] − A − Bn)2
n=0

The quality of any estimator for this problem is related to the assumptions
on the data model. In this example, linear trend and WGN PDF
assumption.

(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

25 / 152

The Mathematical Estimation Problem
Classical versus Bayesian estimation
If we assume θ is deterministic we will have a classical estimation
problem. The following method will be studied : MVU, MLE, BLUE,
LSE.
If we assume θ is a random variable with a known PDF, then we will
have a Bayesian estimation problem. In this case the data are
described as the joint PDF
p(x, θ) = p(x|θ)p(θ)
where p(θ) summarizes our knowledge about θ before any data is
observed and p(x|θ) summarizes our knowledge provided by data x
conditioned on knowing θ. The following methods will be studied :
MMSE, MAP, Kalman Filter.

(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

26 / 152

Assessing Estimator Performance
Consider the problem of estimating a DC level A in uncorrelated noise :
x[n] = A + w [n]

n = 0, 1, . . . , N − 1

Consider the following estimators :
1
ˆ
A1 =
N

N−1

x[n]
n=0

ˆ
A2 = x[0]
ˆ
ˆ
Suppose that A = 1, A1 = 0.95 and A2 = 0.98. Which estimator is better ?

An estimator is a random variable, so its
performance can only be described by its PDF or
statistically (e.g. by Monte-Carlo simulation).
(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

27 / 152

Unbiased Estimators
An estimator that on the average yield the true value is unbiased.
Mathematically
ˆ
E (θ − θ) = 0
for a < θ < b
ˆ
ˆ
Let’s compute the expectation of the two estimators A1 and A2 :
1
ˆ
E (A1 ) =
N

N−1
n=0

1
E (x[n]) =
N

N−1
n=0

1
E (A + w [n]) =
N

N−1

(A + 0) = A
n=0

ˆ
E (A2 ) = E (x[0]) = E (A + w [0]) = A + 0 = A
Both estimators are unbiased. Which one is better ?
Now, let’s compute the variance of the two estimators :
ˆ
var(A1 ) = var

1
N

N−1

x[n] =
n=0

1
N2

N−1

var(x[n]) =
n=0

1
σ2
Nσ 2 =
N2
N

ˆ
ˆ
var(A2 ) = var(x[0]) = σ 2 > var (A1 )
(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

28 / 152

Unbiased Estimators
Remark : When several unbiased estimators of the same parameters from
ˆ
ˆ ˆ
independent set of data are available, i.e., θ1 , θ2 , . . . , θn , a better estimator
can be obtained by averaging :
ˆ 1
θ=
n

n

ˆ
θi

⇒

ˆ
E (θ) = θ

i =1

Assuming that the estimators have the same variance, we have :
1
ˆ
var(θ) = 2
n

n

ˆ
var(θi ) =
i =1

ˆ
1
var(θi )
ˆ
n var(θi ) =
n2
n

ˆ
By increasing n, the variance will decrease (if n → ∞, θ → θ).
It is not the case for biased estimators, no matter how many estimators are
averaged.
(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

29 / 152

Minimum Variance Criterion
The most logical criterion for estimation is the Mean Square Error (MSE) :
ˆ
ˆ
mse(θ) = E [(θ − θ)2 ]
Unfortunately this type of estimators leads to unrealizable estimators (the
estimator will depend on θ).
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
mse(θ) = E {[θ − E (θ) + E (θ) − θ]2 } = E {[θ − E (θ) + b(θ)]2 }
ˆ
where b(θ) = E (θ) − θ is deﬁned as the bias of the estimator. Therefore :
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
mse(θ) = E {[θ − E (θ)]2 } + 2b(θ)E [θ − E (θ)] + b 2 (θ) = var(θ) + b 2 (θ)

Instead of minimizing MSE we can minimize the variance of
the unbiased estimators :
Minimum Variance Unbiased Estimator
(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

30 / 152

Minimum Variance Unbiased Estimator

Existence of MVU Estimator : In general MVU estimator does not
always exist. There may be no unbiased estimator or non of unbiased
estimators has a uniformly minimum variance.
Finding the MVU Estimator : There is no known procedure which
always leads to the MVU estimator. Three existing approaches are :
1

Determine the Cramer-Rao lower bound (CRLB) and check to see if
some estimator satisﬁes it.

2

Apply the Rao-Blackwell-Lehmann-Scheﬀe theorem (we will skip it).

3

Restrict to linear unbiased estimators.

(Minimum Variance Unbiased Estimation)

Estimation Theory

Spring 2013

31 / 152

Cramer-Rao Lower Bound

(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

32 / 152

Cramer-Rao Lower Bound

CRLB is a lower bound on the variance of any unbiased estimator.
ˆ
var(θ) ≥ CRLB(θ)
Note that the CRLB is a function of θ.
It tells us what is the best performance that can be achieved
(useful in feasibility study and comparison with other estimators).
It may lead us to compute the MVU estimator.

(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

33 / 152

Cramer-Rao Lower Bound
Theorem (scalar case)
Assume that the PDF p(x; θ) satisﬁes the regularity condition
E

∂ ln p(x; θ)
=0
∂θ

for all θ

ˆ
Then the variance of any unbiased estimator θ satisﬁes
ˆ
var(θ) ≥ −E

∂ 2 ln p(x; θ)
∂θ 2

−1

An unbiased estimator that attains the CRLB can be found iﬀ :
∂ ln p(x; θ)
= I (θ)(g (x) − θ)
∂θ
ˆ
for some functions g (x) and I (θ). The estimator is θ = g (x) and the
minimum variance is 1/I (θ).
(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

34 / 152

Cramer-Rao Lower Bound
Example : Consider x[0] = A + w [0] with w [0] ∼ N (0, σ 2 ).
p(x[0]; A) = √

1
2πσ 2

exp −

1
(x[0] − A)2
2σ 2

√
1
ln p(x[0], A) = − ln 2πσ 2 − 2 (x[0] − A)2
2σ
Then
1
∂ ln p(x[0]; A)
= 2 (x[0] − A)
∂A
σ

⇒

−

∂ 2 ln p(x[0]; A)
1
= 2
2
∂A
σ

According to Theorem :
ˆ
var (A) ≥ σ 2

(Cramer-Rao Lower Bound)

and

I (A) =

1
σ2

ˆ
and A = g (x[0]) = x[0]

Estimation Theory

Spring 2013

35 / 152

Cramer-Rao Lower Bound
Example : Consider multiple observations for DC level in WGN :
x[n] = A + w [n]

n = 0, 1, . . . , N − 1

with w [n] ∼ N (0, σ 2 )

1
1
exp − 2
p(x; A) = √
2σ
( 2πσ 2 )N

N−1

(x[n] − A)2
n=0

Then
∂ ln p(x; A)
∂A

=

=

∂
1
− ln[(2πσ 2 )N/2 ] − 2
∂A
2σ
1
σ2

N−1

(x[n] − A) =
n=0

N
σ2

1
N

N−1

(x[n] − A)2
n=0
N−1

x[n] − A
n=0

According to Theorem :
σ2
ˆ
var (A) ≥
N
(Cramer-Rao Lower Bound)

N
and I (A) = 2
σ

1
ˆ
and A = g (x[0]) =
N

Estimation Theory

N−1

x[n]
n=0

Spring 2013

36 / 152

Transformation of Parameters
If it is desired to estimate α = g (θ), then the CRLB is :
∂ 2 ln p(x; θ)
∂θ 2

ˆ
var(θ) ≥ −E

−1

∂g
∂θ

2

Example : Compute the CRLB for estimation of the power (A2 ) of a DC
level in noise :
σ2
4A2 σ 2
ˆ
(2A)2 =
var(A2 ) ≥
N
N

Deﬁnition
Eﬃcient estimator : An unbiased estimator that attains the CRLB is said
to be eﬃcient.
Example : Knowing that x =
¯

1
N

N−1

x[n] is an eﬃcient estimator for A, is
n=0

x 2 an eﬃcient estimator for A2 ?
¯
(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

37 / 152

Transformation of Parameters
Solution : Knowing that x ∼ N (A, σ 2 /N), we have :
¯
x
x
E (¯2 ) = E 2 (¯) + var(¯) = A2 +
x

σ2
= A2
N

So the estimator A2 = x 2 is not even unbiased.
¯
Let’s look at the variance of this estimator :
x
x
var(¯2 ) = E (¯4 ) − E 2 (¯2 )
x
but we have from the moments of Gaussian RVs (slide 15) :
E (¯4 ) = A4 + 6A2
x

σ2
σ2
+ 3( )2
N
N

Therefore :
var(¯2 ) = A4 + 6A2
x
(Cramer-Rao Lower Bound)

σ2
σ 2 3σ 4
+ 2 − A2 +
N
N
N
Estimation Theory

2

=

4A2 σ 2 2σ 4
+ 2
N
N
Spring 2013

38 / 152

Transformation of Parameters
Remarks :
The estimator A2 = x 2 is biased and not eﬃcient.
¯
As N → ∞ the bias goes to zero and the variance of the estimator
approaches the CRLB. This type of estimators are called
asymptotically eﬃcient.
General Remarks :
ˆ
If g (θ) = aθ + b is an aﬃne function of θ, then g (θ) = g (θ) is an
ˆ + b) = aθ + b = g (θ),
eﬃcient estimator. First, it is unbiased : E (aθ
moreover :
∂g 2
ˆ
ˆ
var(θ) = a2 var(θ)
var(g (θ)) ≥
∂θ
ˆ
ˆ
but var(g (θ)) = var(aθ + b) = a2 var(θ), so that the CRLB is
achieved.
ˆ
If g (θ) is a nonlinear function of θ and θ is an eﬃcient estimator,
ˆ is an asymptotically eﬃcient estimator.
then g (θ)
(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

39 / 152

Cramer-Rao Lower Bound
Theorem (Vector Parameter)
Assume that the PDF p(x; θ) satisﬁes the regularity condition
E

∂ ln p(x; θ)
=0
∂θ

for all θ

ˆ
Then the variance of any unbiased estimator θ satisﬁes Cθ − I−1 (θ) ≥ 0
ˆ
where ≥ 0 means that the matrix is positive semideﬁnite. I(θ) is called the
Fisher information matrix and is given by :
Iij (θ) = −E

∂ 2 ln p(x; θ)
∂θi ∂θj

An unbiased estimator that attains the CRLB can be found iﬀ :
∂ ln p(x; θ)
= I(θ)(g(x) − θ)
∂θ
(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

40 / 152

CRLB Extension to Vector Parameter
Example : Consider a DC level in WGN with A and σ 2 unknown.
Compute the CRLB for estimation of θ = [A σ 2 ]T .
N
1
N
ln p(x; θ) = − ln 2π − ln σ 2 − 2
2
2
2σ

N−1

(x[n] − A)2
n=0

The Fisher information matrix is :
I(θ) = −E

∂ 2 ln p(x;θ)
∂A2
∂ 2 ln p(x;θ)
∂A∂σ2

∂ 2 ln p(x;θ)
∂A∂σ2
∂ 2 ln p(x;θ)
∂(σ2 )2

=

N
σ2

0

0
N
2σ4

The matrix is diagonal (just for this example) and can be easily inverted to
yield :
ˆ
var(θ) ≥

σ2
N

var(σ 2 ) ≥

2σ 4
N

Is there any unbiased estimator that achieves these bounds ?
(Cramer-Rao Lower Bound)

Estimation Theory

Spring 2013

41 / 152

Transformation of Parameters
ˆ
If it is desired to estimate α = g(θ), and the CRLB for the covariance of θ
−1
is I (θ), then :
Cα ≥
ˆ

∂g
∂θ

∂ 2 ln p(x; θ)
∂θ 2

−E

−1

∂g
∂θ

T

Example : Consider a DC level in WGN with A and σ 2 unknown.
Compute the CRLB for estimation of signal to noise ratio α = A2 /σ 2 .
2
We have θ = [A σ 2 ]T and α = g (θ) = θ1 /θ2 , then the Jacobian is :
∂g (θ)
∂g (θ)
=
∂θ
∂θ1

∂g (θ)
2A
=
∂θ2
σ2

−

A2
σ4

So the CRLB is :
2A
α
var(ˆ ) ≥
σ2
(Cramer-Rao Lower Bound)

A2
− 4
σ

N
σ2

0

0
N
2σ4

Estimation Theory

−1

2A
σ2
−A2
σ4

=

4α + 2α2
N
Spring 2013

42 / 152

Linear Models with WGN
If N point samples of data observed can be modeled as
x = Hθ + w
where
x
H
θ
w

=N ×1
=N ×p
=p×1
=N ×1

observation vector
observation matrix (known, rank p)
vector of parameters to be estimated
noise vector with PDF N (0, σ 2 I)

Compute the CRLB and the MVU estimator that achieves this bound.
Step 1 : Compute ln p(x; θ).
∂ 2 ln p(x; θ)
and the covariance
Step 2 : Compute I(θ) = −E
∂θ 2
ˆ ˆ
matrix of θ : Cθ = I−1 (θ).
Step 3 : Find the MVU estimator g(x) by factoring
∂ ln p(x; θ)
= I(θ)[g(x) − θ]
∂θ
(Linear Models)

Estimation Theory

Spring 2013

43 / 152

Linear Models with WGN
√
1
Step 1 : ln p(x; θ) = − ln( 2πσ 2 )N − 2σ2 (x − Hθ)T (x − Hθ).
Step 2 :
1 ∂ T
∂ ln p(x; θ)
= − 2
[x x − 2xT Hθ + θ T HT Hθ]
∂θ
2σ ∂θ
1 T
[H x − HT Hθ]
=
σ2
Then

I(θ) = −E

1
∂ 2 ln p(x; θ)
= 2 HT H
2
∂θ
σ

Step 3 : Find the MVU estimator g(x) by factoring
HT H
∂ ln p(x; θ)
= I(θ)[g(x) − θ] =
[(HT H)−1 HT x − θ]
∂θ
σ2
Therefore :
ˆ
C ˆ = I−1 (θ) = σ 2 (HT H)−1
θ = g(x) = (HT H)−1 HT x
θ

(Linear Models)

Estimation Theory

Spring 2013

44 / 152

Linear Models with WGN
For a linear model with WGN represented by x = Hθ + w the MVU
estimator is :
ˆ
θ = (HT H)−1 HT x
This estimator is eﬃcient and attains the CRLB.
That the estimator is unbiased can be seen easily by :
ˆ
E (θ) = (HT H)−1 HT E (Hθ + w) = θ
ˆ
ˆ
The statistical performance of θ is completely speciﬁed because θ is a
linear transformation of a Gaussian vector x and hence has a Gaussian
distribution :
ˆ
θ ∼ N (θ, σ 2 (HT H)−1 )

(Linear Models)

Estimation Theory

Spring 2013

45 / 152

Example (Curve Fitting)
Consider ﬁtting the data x[n] by a p-th order polynomial function of n :
x[n] = θ0 + θ1 n + θ2 n2 + · · · + θp np + w [n]
We have N data samples, then :
x = [x[0], x[1], . . . , x[N − 1]]T
w = [w [0], w [1], . . . , w [N − 1]]T
θ = [θ0 , θ1 , . . . , θp ]T
so x = Hθ + w, where H is :

1
0
0
 1
1
1

 1
2
4

 .
.
.
.
.
.
 .
.
.
1 N − 1 (N − 1)2

···
···
···
..
.

0
1
2p
.
.
.

···

(N − 1)p








N×(p+1)

ˆ
Hence the MVU estimator is : θ = (HT H)−1 HT x
(Linear Models)

Estimation Theory

Spring 2013

46 / 152

Example (Fourier Analysis)
Consider the Fourier analysis of the data x[n] :
M

ak cos(

x[n] =
k=1

2πkn
)+
N

M

bk sin(
k=1

2πkn
) + w [n]
N

so we have θ = [a1 , a2 , . . . , aM , b1 , b2 , . . . , bM ]T and x = Hθ + w where :
H = [ha , ha , . . . , ha , hb , hb , . . . , hb ]
1 2
M
1 2
M
with


ha
k




=



1
cos( 2πk )
N
cos( 2πk2 )
N
.
.
.










,

hb
k

cos( 2πk(N−1) )
N




=





1
sin( 2πk )
N
sin( 2πk2 )
N
.
.
.








sin( 2πk(N−1) )
N

ˆ
Hence the MVU estimate of the Fourier coeﬃcients is : θ = (HT H)−1 HT x
(Linear Models)

Estimation Theory

Spring 2013

47 / 152

Example (Fourier Analysis)
After simpliﬁcation (noting that (HT H)−1 =

2
N I),

we have :

2
ˆ
θ = [(ha )T x, . . . , (ha )T x , (hb )T x, . . . , (hb )T x]T
M
1
M
N 1
which is the same as the standard solution :
2
a
ˆk =
N

N−1

x[n] cos
n=0

2πkn
N

,

2
ˆ
bk =
N

N−1

x[n] sin
n=0

2πkn
N

From the properties of linear models the estimates are unbiased.
The covariance matrix is :
Cθ = σ 2 (HT H)−1 =
ˆ

2σ 2
I
N

ˆ
Note that θ is Gaussian and Cθ is diagonal (the amplitude estimates
ˆ
are independent).
(Linear Models)

Estimation Theory

Spring 2013

48 / 152

Example (System Identiﬁcation)
Consider identiﬁcation of a Finite Impulse Response (FIR) model, h[k] for
k = 0, 1, . . . , p − 1, with input u[n] and output x[n] provided for
n = 0, 1, . . . , N − 1 :
p−1

h[k]u[n − k] + w [n]

x[n] =

n = 0, 1, . . . , N − 1

k=0

FIR model can be represented by the linear model x = Hθ + w where




u[0]
0
···
0
h[0]
 u[1]

u[0]
···
0
 h[1] 



H=
θ=

.
.
.
..


.
.
.
...


.
.
.
.
h[p − 1] p×1
u[N − 1] u[N − 2] · · · u[N − p] N×p
ˆ
The MVU estimate is θ = (HT H)−1 HT x with Cθ = σ 2 (HT H)−1 .
ˆ
(Linear Models)

Estimation Theory

Spring 2013

49 / 152

Linear Models with Colored Gaussian Noise
Determine the MVU estimator for the linear model x = Hθ + w with w a
colored Gaussian noise with N (0, C).
Whitening approach : Since C is positive deﬁnite, its inverse can be
factored as C−1 = DT D where D is an invertible matrix. This matrix acts
as a whitening transformation for w :
E [(Dw)(Dw)T ] = E (DwwT D) = DCDT = DD−1 D−T D = I
Now if we transform the linear model x = Hθ + w to :
x = Dx = DHθ + Dw = H θ + w
where w = Dw ∼ N (0, I) is white and we can compute the MVU
estimator as :
ˆ
θ = (H T H )−1 H T x = (HT DT DH)−1 HT DT Dx
so, we have :
ˆ
θ = (HT C−1 H)−1 HT C−1 x with Cθ = (H T H )−1 = (HT C−1 H)−1
ˆ
(Linear Models)

Estimation Theory

Spring 2013

50 / 152

Linear Models with known components
Consider a linear model x = Hθ + s + w, where s is a known signal. To
determine the MVU estimator let x = x − s, so that x = Hθ + w is a
standard linear model. The MVU estimator is :
ˆ
θ = (HT H)−1 HT (x − s) with C ˆ = σ 2 (HT H)−1
θ

Example : Consider a DC level and exponential in WGN :
x[n] = A + r n + w [n] where r is known. Then we have :
 


  
w [0]
1
1
x[0]
 r   w [1]
 x[1]   1 
 
  



 =  . A +  .  + 
.
.
.
.

  . 
 .  
.
.
.
.
x[N − 1]

r N−1

1







w [N − 1]

The MVU estimator is :
1
ˆ
A = (HT H)−1 HT (x − s) =
N
(Linear Models)

N−1

ˆ
(x[n] − r n ) with var(A) =
n=0

Estimation Theory

Spring 2013

σ2
N
51 / 152

Best Linear Unbiased Estimators (BLUE)
Problems of ﬁnding the MVU estimators :
The MVU estimator does not always exist or impossible to ﬁnd.
The PDF of data may be unknown.
BLUE is a suboptimal estimator that :
restricts estimates to be linear in data ;
restricts estimates to be unbiased ;

ˆ
θ = Ax

ˆ
E (θ) = AE (x) = θ

minimizes the variance of the estimates ;
needs only the mean and the variance of the data (not the PDF). As
a result, in general, the PDF of the estimates cannot be computed.
Remark : The unbiasedness restriction implies a linear model for the data.
However, it may still be used if the data are transformed suitably or the
model is linearized.
(Best Linear Unbiased Estimators)

Estimation Theory

Spring 2013

52 / 152

Finding the BLUE (Scalar Case)
1

Choose a linear estimator for the observed data
x[n]

,

n = 0, 1, . . . , N − 1

N−1

ˆ
θ=

an x[n] = aT x

where a = [a0 , a1 , . . . , aN−1 ]T

n=0
2

Restrict estimate to be unbiased :
N−1

ˆ
E (θ) =

an E (x[n]) = θ
n=0

3

Minimize the variance
ˆ
ˆ
ˆ
var(θ) = E {[θ − E (θ)]2 } = E {[aT x − aT E (x)]2 }
= E {aT [x − E (x)][x − E (x)]T a} = aT Ca

(Best Linear Unbiased Estimators)

Estimation Theory

Spring 2013

53 / 152

Finding the BLUE (Scalar Case)
Consider the problem of amplitude estimation of known signals in noise :
x[n] = θs[n] + w [n]
N−1
1

ˆ
Choose a linear estimator : θ =

an x[n] = aT x
n=0

2

3

ˆ
Restrict estimate to be unbiased : E (θ) = aT E (x) = aT sθ = θ
T s = 1 where s = [s[0], s[1], . . . , s[N − 1]]T
then a
Minimize aT Ca subject to aT s = 1.

The constrained optimization can be solved using Lagrangian Multipliers :
Minimize

J = aT Ca + λ(aT s − 1)

The optimal solution is :
T −1
ˆ s C x
θ = T −1
s C s
(Best Linear Unbiased Estimators)

and

ˆ
var(θ) =

Estimation Theory

1
sT C−1 s
Spring 2013

54 / 152

Finding the BLUE (Vector Case)
Theorem (Gauss–Markov)
If the data are of the general linear model form
x = Hθ + w
with w is a noise vector with zero mean and covariance C (the PDF of w
is arbitrary), then the BLUE of θ is :
ˆ
θ = (HT C−1 H)−1 HT C−1 x
ˆ
and the covariance matrix of θ is
Cθ = (HT C−1 H)−1
ˆ
Remark : If noise is Gaussian then BLUE is MVU estimator.
(Best Linear Unbiased Estimators)

Estimation Theory

Spring 2013

55 / 152

Finding the BLUE
Example : Consider the problem of DC level in noise : x[n] = A + w [n],
2
where w [n] is of unspeciﬁed PDF with var(w [n]) = σn . We have θ = A
T . The covariance matrix is :
and H = 1 = [1, 1, . . . , 1]
 1


 2
0 ···
0
2
σ0
0
σ0 0 · · ·
 0 1 ···
 0 σ2 · · ·
0 
2
0 


1


−1
 . σ.1
C= .
. ..
.  ⇒ C = .
. 
.
.
. 
. ...
. 
 .
.
.
.
.
. 
 .
2
1
0 0 · · · σN−1
0 0 · · · σ2
N−1

and hence the BLUE is :
ˆ
θ = (H C
T

−1

−1

H)

−1

T

H C

N−1

x=
n=0

1
2
σn

−1 N−1
n=0

x[n]
2
σn

and the minimum covariance is :
T

Cθ = (H C
ˆ

−1

−1

H)

N−1

=
n=0

(Best Linear Unbiased Estimators)

Estimation Theory

1
2
σn

−1

Spring 2013

56 / 152

Maximum Likelihood Estimation

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

57 / 152

Maximum Likelihood Estimation
Problems : MVU estimator does not often exist or cannot be found.
BLUE is restricted to linear models.
Maximum Likelihood Estimator (MLE) :
can always be applied if the PDF is known ;
is optimal for large data size ;
is computationally complex and requires numerical methods.
Basic Idea : Choose the parameter value that makes the observed data,
the most likely data to have been observed.
Likelihood Function : is the PDF p(x; θ) when θ is regarded as a variable
(not a parameter).
ML Estimate : is the value of θ that maximizes the likelihood function.
Procedure : Find log-likelihood function ln p(x; θ) ; diﬀerentiate w.r.t θ
and set to zero and solve for θ.
(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

58 / 152

Maximum Likelihood Estimation
Example : Consider DC level in WGN with unknown variance
x[n] = A + w [n]. Suppose that A > 0 and σ 2 = A. The PDF is :
1
p(x; A) =
N exp −
2A
(2πA) 2
1

N−1

(x[n] − A)2
n=0

Taking the derivative of the log-likelihood function, we have :
N
1
∂ ln p(x; A)
=−
+
∂A
2A A

N−1

(x[n] − A) +
n=0

1
2A2

N−1

(x[n] − A)2
n=0

What is the CRLB ? Does an MVU estimator exist ?
MLE can be found by setting the above equation to zero :
1
ˆ
A=− +
2
(Maximum Likelihood Estimation)

1
N

N−1

x 2 [n] +
n=0

Estimation Theory

1
4
Spring 2013

59 / 152

Stochastic Convergence
Convergence in distribution : Let {p(xN )} be a sequence of PDF. If
there exists a PDF p(x) such that
lim p(xN ) = p(x)

N→∞

at every point x at which p(x) is continuous, we say that p(xN ) converges
d

in distribution to p(x). We write also xN → x.

Example
Consider N independent RV x1 , x2 , . . . , xN with mean µ and ﬁnite variance
N
1
¯
xn , then according to the Central Limit Theorem
σ 2 . Let xN =
N
n=1
√ xN − µ
¯
converges in distribution to z ∼ N (0, 1).
(CLT), zN = N
σ

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

60 / 152

Stochastic Convergence
Convergence in probability : Sequence of random variables {xN }
converges in probability to the random variable x if for every > 0
lim Pr {|xN − x| > } = 0

N→∞

Convergence with probability 1 (almost sure convergence) :
Sequence of random variables {xN } converges with probability 1 to the
random variable x if and only if for all possible events
Pr { lim xN = x} = 1
N→∞

Example
Consider N independent RV x1 , x2 , . . . , xN with mean µ and ﬁnite variance
N
1
¯
xn . Then according to the Law of Large Numbers
σ 2 . Let xN =
N
n=1
(LLN), zN converges in probability to µ.
¯
(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

61 / 152

Asymptotic Properties of Estimators
ˆ
Asymptotic Unbiasedness : Estimator θN is an asymptotically unbiased
estimator of θ if :
ˆ
lim E (θN − θ) = 0
N→∞

Asymptotic Distribution : It refers to p(xn ) as it evolves from
n = 1, 2, . . ., especially for large value of n (it is not the ultimate form of
distribution, which may be degenerate).
ˆ
Asymptotic Variance : is not equal to lim var(θN ) (which is the
N→∞

limiting variance). It is deﬁned as :
1
ˆ
ˆ
ˆ
lim E {N[θN − lim E (θN )]2 }
asymptotic var(θN ) =
N→∞
N N→∞
ˆ
Mean-Square Convergence : Estimator θN converges to θ in a
mean-squared sense, if :
ˆ
lim E [(θN − θ)2 ] = 0
N→∞

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

62 / 152

Consistency
ˆ
Estimator θN is a consistent estimator of θ if for every
ˆ
plim(θN ) = θ

⇔

>0

ˆ
lim Pr [|θN − θ| > ] = 0

N→∞

Remarks :
ˆ
If θN is asymptotically unbiased and its limiting variance is zero then
it converges to θ in mean-square.
ˆ
If θN converges to θ in mean-square, then the estimator is consistent.
Asymptotic unbiasedness does not imply consistency and vice versa.
plim can be treated as an operator, e.g. :
plim(xy ) = plim(x)plim(y ) ;

plim

x
y

=

plim(x)
plim(y )

The importance of consistency is that any continuous function of a
consistent estimator is itself a consistent estimator.
(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

63 / 152

Maximum Likelihood Estimation
Properties : MLE may be biased and is not necessarily an eﬃcient
estimator. However :
MLE is a consistent estimator meaning that
ˆ
lim Pr [|θ − θ| > ] = 0

N→∞

MLE asymptotically attains the CRLB (asymptotic variance is equal
to CRLB).
Under some “regularity” conditions, the MLE is asymptotically
normally distributed
ˆ a
θ ∼ N (θ, I−1 (θ))
even if the PDF of x is not Gaussian.
If an MVU estimator exists then ML procedure will ﬁnd it.

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

64 / 152

Maximum Likelihood Estimation
Example
Consider DC level in WGN with known variance σ 2 .
Sol. Then
p(x; A) =

1
N

(2πσ 2 ) 2

1
∂ ln p(x; A)
= 2
∂A
σ

exp −

1
2σ 2

N−1

(x[n] − A)2
n=0

N−1

(x[n] − A) = 0
n=0

N−1

ˆ
x[n] − N A = 0

⇒
n=0

1
ˆ ¯
which leads to A = x =
N
(Maximum Likelihood Estimation)

N−1

x[n]
n=0

Estimation Theory

Spring 2013

65 / 152

MLE for Transformed Parameters (Invariance Property)
Theorem (Invariance Property of the MLE)
The MLE of the parameter α = g (θ), where the PDF p(x; θ) is
parameterized by θ, is given by
ˆ
α = g (θ)
ˆ
ˆ
where θ is the MLE of θ.
It can be proved using the property of the consistent estimators.
If α = g (θ) is a one-to-one function, then
ˆ
α = arg max p(x; g −1 (α)) = g (θ)
ˆ
α

If α = g (θ) is not a one-to-one function, then
pT (x; α) =
¯

max

{θ:α=g (θ)}

(Maximum Likelihood Estimation)

p(x; θ)

and

Estimation Theory

ˆ
α = arg max pT (x; θ) = g (θ)
ˆ
¯
α

Spring 2013

66 / 152

MLE for Transformed Parameters (Invariance Property)
Example
Consider DC level in WGN and ﬁnd MLE of α = exp(A). Since g (θ) is a
one-to-one function then :
x
α = arg max pT (x, α) = arg max p(x; ln α) = exp(¯)
ˆ
α

α

Example
Consider DC level in WGN and ﬁnd MLE of α = A2 . Since g (θ) is not a
one-to-one function then :
√
√
α = arg max{p(x; α), p(x; − α)}
ˆ
α≥0

=

√
√
arg √ {p(x; α), p(x; − α)}
max

=

arg

2

α≥0

2

(Maximum Likelihood Estimation)

max

−∞<A<∞

p(x; A)

Estimation Theory

ˆ
= A2 = x 2
¯
Spring 2013

67 / 152

MLE (Extension to Vector Parameter)
Example
Consider DC Level in WGN with unknown variance. The vector parameter
θ = [A σ 2 ]T should be estimated.
We have :
N−1

∂ ln p(x; θ)
∂A

=

∂ ln p(x; θ)
∂σ 2

N
1
= − 2+ 4
2σ
2σ

1
σ2

(x[n] − A)
n=0
N−1

(x[n] − A)2
n=0

which leads to the following MLE :
ˆ ¯
A=x

(Maximum Likelihood Estimation)

1
ˆ
σ2 =
N

N−1

(x[n] − x )2
¯
n=0

Estimation Theory

Spring 2013

68 / 152

MLE for General Gaussian Case
Consider the general Gaussian case where x ∼ N (µ(θ), C(θ)).
The partial derivative of the PDF is :
∂ ln p(x; θ)
∂θk

1
∂C(θ)
= − tr C−1 (θ)
2
∂θk

+

∂µ(θ)T −1
C (θ)(x − µ(θ))
∂θk

∂C−1 (θ)
1
(x − µ(θ))
− (x − µ(θ))T
2
∂θk
for k = 1, . . . , p.
By setting the above equations equal to zero, MLE can be found.
A particular case is when C is known (the ﬁrst and third terms
become zero).
In addition, if µ(θ) is linear in θ, the general linear model is obtained.

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

69 / 152

MLE for General Linear Models
Consider the general linear model x = Hθ + w where w is a noise vector
with PDF N (0, C) :
p(x; θ) =

1
(2π)N

1
exp − (x − Hθ)T C−1 (x − Hθ)
2
det(C)

Taking the derivative of ln p(x; θ) leads to :
∂(Hθ)T −1
∂ ln p(x; θ)
=
C (x − Hθ)
∂θ
∂θ
Then
HT C−1 (x − Hθ) = 0

⇒

ˆ
θ = (HT C−1 H)−1 HT C−1 x

ˆ
which is the same as MVU estimator. The PDF of θ is :
ˆ
θ ∼ N (θ, (HT C−1 H)−1 )
(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

70 / 152

MLE (Numerical Method)
Newton–Raphson : A closed form estimator cannot be always computed
by maximizing the likelihood function. However, the maximum value can
be computed by the numerical methods like the iterative Newton–Raphson
algorithm.
θk+1

∂ 2 ln p(x; θ)
= θk −
∂θ∂θ T

−1

∂ ln p(x; θ)
∂θ

θ=θk

Remarks :
The Hessian can be replaced by the negative of its expectation, the
Fisher information matrix I(θ).
This method suﬀers from convergence problems (local maximum).
Typically, for large data length, the log-likelihood function becomes
more quadratic and the algorithm will produce the MLE.

(Maximum Likelihood Estimation)

Estimation Theory

Spring 2013

71 / 152

Least Squares Estimation

(Least Squares)

Estimation Theory

Spring 2013

72 / 152

The Least Squares Approach
In all the previous methods we assumed that the measured signal x[n] is
the sum of a true signal s[n] and a measurement error w [n] with known
probabilistic model. In least squares method
x[n] = s[n, θ] + e[n]
where e(n) represents the modeling and measurement errors. The objective
is to minimize the LS cost :
N−1

(x[n] − s[n, θ])2

J(θ) =
n=0

We do not need a probabilistic assumption but only
a deterministic signal model.
It has a broader range of applications.
No claim about the optimality can be made.
The statistical performance cannot be assessed.
(Least Squares)

Estimation Theory

Spring 2013

73 / 152

The Least Squares Approach

Example
Estimate the DC level of a signal. We observe x[n] = A + [n] for
n = 0, . . . , N − 1 and the LS criterion is :
N−1

(x[n] − A)2

J(A) =
n=0

∂J(A)
= −2
∂A

(Least Squares)

N−1

(x[n] − A) = 0
n=0

Estimation Theory

⇒

1
ˆ
A=
N

N−1

x[n]
n=0

Spring 2013

74 / 152

Linear Least Squares
Suppose that the observation model is linear x = Hθ +

then

N−1

(x[n] − s[n, θ])2 = (x − Hθ)T (x − Hθ)

J(θ) =
n=0

= xT x − 2xT Hθ + θ T HT Hθ
where H is full rank. The gradient is
∂J(θ)
= −2HT x + 2HT Hθ = 0
∂θ

ˆ
⇒ θ = (HT H)−1 HT x

The minimum LS cost is :
ˆ
ˆ
Jmin = (x − Hθ)T (x − Hθ) = xT [I − H(HT H)−1 HT ]x = xT (x − Hθ)
where I − H(HT H)−1 HT is an Idempotent matrix.
(Least Squares)

Estimation Theory

Spring 2013

75 / 152

Comparing Diﬀerent Estimators for the Linear Model
Consider the following linear model
x = Hθ + w

Estimator

Assumption

Estimate

No probabilistic assumption

ˆ
θ = (HT H)−1 HT x

BLUE

w is white with unknown PDF

ˆ
θ = (HT H)−1 HT x

MLE

w is white Gaussian noise

ˆ
θ = (HT H)−1 HT x

MVUE

w is white Gaussian noise

ˆ
θ = (HT H)−1 HT x

LSE

For MLE and MVUE the PDF of the estimate will be
Gaussian.
(Least Squares)

Estimation Theory

Spring 2013

76 / 152

Weighted Linear Least Squares
The LS criterion can be modiﬁed by including a positive deﬁnite
(symmetric) weighting matrix W :
J(θ) = (x − Hθ)T W(x − Hθ)
That leads to the following estimator :
ˆ
θ = (HT WH)−1 HT Wx
and minimum LS cost :
Jmin = xT [W − WH(HT WH)−1 HT W]x
Remark : If we take W = C−1 , where C is the covariance of noise then
weighted least squares estimator is the BLUE. However, there is no true
LS-based reason for this choice.
(Least Squares)

Estimation Theory

Spring 2013

77 / 152

Geometrical Interpretation
Recall the general signal model s = Hθ. If we denote the column of H by
hi we have :


θ1
p
 θ2 


θi hi
s = [h1 h2 · · · hp ]  .  =
 . 
.
θp

i =1

The signal model is a linear combination of the vectors {hi }.
The LS minimizes the length of the error vector between the data and
the signal model = x − s :
J(θ) = (x − Hθ)T (x − Hθ) = x − Hθ

2

The data vector can lie anywhere in R N , while signal vectors must lie
in a p-dimensional subspace of R N , termed S p , which is spanned by
the column of H.
(Least Squares)

Estimation Theory

Spring 2013

78 / 152

Geometrical Interpretation (Orthogonal Projection)
ˆ
Intuitively, it is clear that the LS error is minimized when ˆ = Hθ is
s
p.
the orthogonal projection of x onto S
So the LS error vector = x − ˆ is orthogonal to all columns of H :
s
HT = 0

⇒

ˆ
HT (x − Hθ) = 0

⇒

ˆ
θ = (HT H)−1 HT x

The signal estimate is the projection of x onto S p :
ˆ
ˆ = Hθ = H(HT H)−1 HT x = Px
s
where P is the orthogonal projection matrix.
Note that if z ∈ Range(H), then Pz = z. Recall that Range(H) is the
subspace spanned by the columns of H.
Now, since Px ∈ S p then P(Px) = Px. Therefore any projection
matrix is idempotent, i.e. P2 = P.
It can be veriﬁed that P is symmetric and singular (with rank p).
(Least Squares)

Estimation Theory

Spring 2013

79 / 152

Geometrical Interpretation (Orthonormal columns of H)
Recall that



HT H = 


< h1 , h1 > < h1 , h2 > · · ·
< h2 , h1 > < h2 , h2 > · · ·
.
.
..
.
.
.
.
.
< hp , h1 > < hp , h2 > · · ·


< h1 , hp >
< h2 , hp > 


.
.

.
< hp , hp >

ˆ
If the columns of H are orthonormal then HT H = I and θ = HT x.
T
ˆ
In this case we have θi = h x, thus
i

p

p

ˆ
θi hi =

ˆ
ˆ = Hθ =
s
i =1

(hT x)hi
i
i =1

If we increase the number of parameters (the order of the linear
model), we can easily compute the new estimate.
(Least Squares)

Estimation Theory

Spring 2013

80 / 152

Choosing the Model Order
Suppose that you have a set of data and the objective is to ﬁt a
polynomial to data. What is the best polynomial order ?
Remarks :
It is clear that by increasing the order Jmin is monotonically
non-increasing.
By choosing p = N we can perfectly ﬁt the data to model. However,
we ﬁt the noise as well.
We should choose the simplest model that adequately describes the
data.
We increase the order only if the cost reduction is signiﬁcant.
If we have an idea about the expected level of Jmin , we increase p to
approximately attain this level.
There is an order-recursive LS algorithm to eﬃciently compute a
(p + 1)-th order model based on a p-th order one (See 8.6).
(Least Squares)

Estimation Theory

Spring 2013

81 / 152

Sequential Least Squares
ˆ
Suppose that θ[N − 1] based on x[N − 1] = x[0], . . . , x[N − 1] is
ˆ
available. If we get a new data x[N], we want to compute θ[N] as a
ˆ − 1] and x[N].
function of θ[N

Example
Consider LS estimate of DC level :

ˆ
A[N] =

1
N +1

N

x[n] =
n=0

1
ˆ
A[N − 1] =
N
1
N +1

N

1
N

N−1

x[n]. We have :
n=0

N−1

x[n] + x[N]
n=0

1
N ˆ
A[N − 1] +
x[N]
=
N +1
N +1
1
ˆ
ˆ
(x[N] − A[N − 1])
= A[N − 1] +
N +1
new estimate = old estimate + gain × prediction error
(Least Squares)

Estimation Theory

Spring 2013

82 / 152

Sequential Least Squares
Example (DC level in uncorrelated noise)
2
x[n] = A + w [n] and var(w [n]) = σn . The WLS estimate (or BLUE) is :

ˆ
A[N − 1] =

N−1 x[n]
2
n=0 σn
N−1 1
2
n=0 σn

Similar to the previous example we can obtain :
ˆ
ˆ
A[N] = A[N − 1] +

2
1/σN
N−1 1
2
n=0 σn

ˆ
x[N] − A[N − 1]

ˆ
ˆ
= A[N − 1] + K [N] x[N] − A[N − 1]
The gain factor K [N] can be reformulated as :
K [N] =

ˆ
var(A[N − 1])
ˆ
var(A[N − 1]) + σ 2

N

(Least Squares)

Estimation Theory

Spring 2013

83 / 152

Sequential Least Squares
Consider the general linear model x = Hθ + w, where w is an uncorrelated
noise with the covariance matrix C. The BLUE (or WLS) is :
ˆ
θ = (HT C−1 H)−1 HT C−1 x and Cθ = (HT C−1 H)−1
ˆ
Let’s deﬁne :
2
2
2
C[n] = diag(σ0 , σ1 , . . . , σn )
H[n − 1]
n×p
=
H[n] =
T
1×p
h [n]

x[n] =

x[0], x[1], . . . , x[n]

ˆ
The objective is to ﬁnd θ[n], based on n + 1 data samples, as a function of
ˆ
θ[n − 1] and new data x[n]. The batch estimator is :
ˆ
θ[n − 1] = Σ[n − 1]HT [n − 1]C−1 [n − 1]x[n − 1]
with Σ[n − 1] = (HT [n − 1]C−1 [n − 1]H[n − 1])−1
(Least Squares)

Estimation Theory

Spring 2013

84 / 152

Sequential Least Squares
Estimator Update :
ˆ
ˆ
ˆ
θ[n] = θ[n − 1] + K[n] x[n] − hT [n]θ[n − 1]
where
K[n] =

2
σn

Σ[n − 1]h[n]
+ hT [n]Σ[n − 1]h[n]

Covariance Update :
Σ[n] = (I − K[n]hT [n])Σ[n − 1]
The following Lemma is used to compute the updates :

Matrix Inversion Lemma
(A + BCD)−1 = A−1 − A−1 B[C−1 + DA−1 B]−1 DA−1
2
with A = Σ−1 [n − 1], B = h[n], C = 1/σn , D = hT [n].

Initialization ?
(Least Squares)

Estimation Theory

Spring 2013

85 / 152

Constrained Least Squares
Linear constraints in the form Aθ = b can be considered in LS solution.
The LS criterion becomes :
Jc (θ) = (x − Hθ)T (x − Hθ) + λT (Aθ − b)
∂Jc
= −2HT x + 2HT Hθ + AT λ
∂θ
Setting the gradient equal to zero produces :
ˆ
θc

1
= (HT H)−1 HT x − (HT H)−1 AT λ
2
λ
ˆ
= θ − (HT H)−1 AT
2

ˆ
where θ = (HT H)−1 HT x is the unconstrained LSE.
ˆ
Now Aθc = b can be solved to ﬁnd λ :
ˆ
λ = 2[A(HT H)−1 AT ]−1 (Aθ − b)
(Least Squares)

Estimation Theory

Spring 2013

86 / 152

Nonlinear Least Squares
Many applications have nonlinear observation model : s(θ) = Hθ. This
leads to a nonlinear optimization problem that can be solved numerically.
Newton-Raphson Method : Find a zero of the gradient of the criterion
by linearizing the gradient around the current estimate.
ˆ
ˆ
θk+1 = θk −

where g(θ) =

−1

∂g(θ)
∂θ

g(θ)
ˆ
θ=θk

∂sT (θ)
[x − s(θ)] and
∂θ

∂[g(θ)]i
=
∂θj

N−1

(x[n] − s[n])
n=0

∂ 2 s[n] ∂s[n] ∂s[n]
−
∂θi θj
∂θj ∂θi

Around the solution [x − s(θ)] is small so the ﬁrst term in the Jacobian
can be neglected. This makes this method equivalent to the Gauss-Newton
algorithm which is numerically more robust.
(Least Squares)

Estimation Theory

Spring 2013

87 / 152

Nonlinear Least Squares
Gauss-Newton Method : Linearize signal model around the current
estimate and solve the resulting linear problem.
s(θ) ≈ s(θ0 ) +

∂s(θ)
∂θ

θ=θ0

(θ − θ0 ) = s(θ0 ) + H(θ0 )(θ − θ0 )

The solution to the linearized problem is :
ˆ
θ = [HT (θ0 )H(θ0 )]−1 HT (θ0 )[x − s(θ0 ) + H(θ0 )θ0 ]
= θ0 + [HT (θ0 )H(θ0 )]−1 HT (θ0 )[x − s(θ0 )]
If we now iterate the solution, it becomes :
ˆ
ˆ
ˆ
ˆ
ˆ
ˆ
θk+1 = θk + [HT (θk )H(θk )]−1 HT (θk )[x − s(θk )]
Remark : Both the Newton-Raphson and the Gauss-Newton methods can
have convergence problems.
(Least Squares)

Estimation Theory

Spring 2013

88 / 152

Nonlinear Least Squares
Transformation of parameters : Transform into a linear problem by
seeking for an invertible function α = g(θ) such that :
s(θ) = s(g−1 (α)) = Hα
ˆ
ˆ
ˆ
So the nonlinear LSE is θ = g−1 (α) where α = (HT H)−1 HT x.

Example (Estimate the amplitude and phase of a sinusoidal signal)
s[n] = A cos(2πf0 n + φ)

n = 0, 1, . . . , N − 1

The LS problem is nonlinear, however, we have :
A cos(2πf0 n + φ) = A cos φ cos 2πf0 n − A sin φ sin 2πf0 n
if we let α1 = A cos φ and α2 = −A sin φ then the signal model becomes
linear s = Hα. The LSE is α = (HT H)−1 HT x and g−1 (α) is
ˆ
A=
(Least Squares)

α2 + α2
1
2

and

φ = arctan

Estimation Theory

−α2
α1
Spring 2013

89 / 152

Nonlinear Least Squares
Separability of parameters : If the signal model is linear in some of the
parameters, try to write it as s = H(α)β. The LS error can be minimized
wrt β.
ˆ
β = [HT (α)H(α)]−1 HT (α)x
The cost function is a function of α that can be minimized by a
numerical method (e.g. brute force).
ˆ
J(α, β) = xT I − H(α)[HT (α)H(α)]−1 HT (α) x
Then
α = arg max
ˆ
α

xT H(α)[HT (α)H(α)]−1 HT (α) x

Remark : This method is interesting if the dimension of α is much less
than the dimension of β.
(Least Squares)

Estimation Theory

Spring 2013

90 / 152

Nonlinear Least Squares
Example (Damped Exponentials)
Consider the following signal model :
s[n] = A1 r n + A2 r 2n + A3 r 3n

n = 0, 1, . . . , N − 1

with θ = [A1 , A2 , A3 , r ]T . It is known that 0 < r < 1.
β = [A1 , A2 , A3 ]T so we get s = H(r )β with :

1
1
1
2
 r
r3
r

H(r ) =  .
.
.
.
.
 .
.
.
.

Let’s take






r N−1 r 2(N−1) r 3(N−1)
r
Step 1 : Maximize xT H(r )[HT (r )H(r )]−1 HT (r ) x to obtain ˆ.
ˆ
r
r
r
Step 2 : Compute β = [HT (ˆ)H(ˆ)]−1 HT (ˆ)x.
(Least Squares)

Estimation Theory

Spring 2013

91 / 152

The Bayesian Philosophy

(The Bayesian Philosophy)

Estimation Theory

Spring 2013

92 / 152

Introduction
Classical Approach :
Assumes θ is unknown but deterministic.
Some prior knowledge on θ cannot be used.
Variance of the estimate may depend on θ.
MVUE may not exist.
In Monte-Carlo Simulations, we do M runs for each ﬁxed θ and then
compute sample mean and variance for each θ (no averaging over θ).
Bayesian Approach :
Assumes θ is random with a known prior PDF, p(θ).
We estimate a realization of θ based on the available data.
Variance of the estimate does not depend on θ.
A Bayesian estimate always exists
In Monte-Carlo simulations, we do M runs for randomly chosen θ and
then we compute sample mean and variance over all θ values.
(The Bayesian Philosophy)

Estimation Theory

Spring 2013

93 / 152

Mean Square Error (MSE)
Classical MSE
Classical MSE is a function of the unknown parameter θ and cannot be
used for constructing the estimators.
ˆ
ˆ
mse(θ) = E {[θ − θ(x)]2 } =

ˆ
[θ − θ(x)]2 p(x; θ)dx

Note that the E {·} is wrt the PDF of x.

Bayesian MSE :
Bayesian MSE is not a function of θ and can be minimized to ﬁnd an
estimator.
ˆ
ˆ
Bmse(θ) = E {[θ − θ(x)]2 } =

ˆ
[θ − θ(x)]2 p(x, θ)d xd θ

Note that the E {·} is wrt the joint PDF of x and θ.
(The Bayesian Philosophy)

Estimation Theory

Spring 2013

94 / 152

Minimum Mean Square Error Estimator
Consider the estimation of A that minimizes the Bayesian MSE, where A is
a random variable with uniform PDF p(A) = U [−A0 , A0 ] and independent
of w [n].
ˆ
Bmse(θ) =

ˆ
[A − A]2 p(x, θ)d xdA =

ˆ
[A − A]2 p(A|x)dA p(x)d x

where we used Bayes’ theorem : p(x, θ) = p(A|x)p(x).
Since p(x) ≥ 0 for all x, we need only minimize the integral in brackets.
We set the derivative equal to zero :
∂
ˆ
∂A

ˆ
[A − A]2 p(A|x)dA = −2

ˆ
Ap(A|x)dA + 2A

p(A|x)dA

which results in
ˆ
A=

Ap(A|x)dA = E (A|x)

Bayesian MMSE Estimate : is the conditional mean of A given data x
or the mean of posterior PDF p(A|x).
(The Bayesian Philosophy)

Estimation Theory

Spring 2013

95 / 152

Minimum Mean Square Error Estimator
How to compute the Bayesian MMSE estimate :
ˆ
A = E (A|x) =

Ap(A|x)dA

The posteriori PDF can be computed using Bayes’ Rule :
p(A|x) =

p(x|A)p(A)
=
p(x)

p(x|A)p(A)
p(x|A)p(A)dA

p(x) is the marginal PDF deﬁned as p(x) = p(x, A)dA.
The integral in the denominator acts as a ”
normalization” of
p(x|A)p(A) such the integral of p(A|x) be equal to 1.
p(x|A) has exactly the same form as p(x; A) which is used in the
classical estimation.
The MMSE estimator always exists and can be computed by :
ˆ
A=
(The Bayesian Philosophy)

Ap(x|A)p(A)dA
p(x|A)p(A)dA

Estimation Theory

Spring 2013

96 / 152

Minimum Mean Square Error Estimator
Example : For p(A) = U [−A0 , A0 ] we have :

ˆ
A=

1
2A0
1
2A0

A0

A
−A0
A0
−A0

1
−1
exp
2 )N/2
2σ 2
(2πσ

−1
1
exp
2σ 2
(2πσ 2 )N/2

N−1

(x[n] − A)2 dA

n=0
N−1

(x[n] − A)2 dA
n=0

Before collecting the data the mean of the prior PDF p(A) is the best
estimate while after collecting the data the best estimate is the mean
of posterior PDF p(A|x).
Choice of p(A) is crucial for the quality of the estimation.
Only Gaussian prior PDF leads to a closed-form estimator.
Conclusion : For an accurate estimator choose a prior PDF that can be
physically justiﬁed. For a closed-form estimator choose a Gaussian prior
PDF.
(The Bayesian Philosophy)

Estimation Theory

Spring 2013

97 / 152

Properties of the Gaussian PDF
Theorem (Conditional PDF of Bivariate Gaussian)
If x and y are distributed according to a bivariate Gaussian PDF :
p(x, y ) =

2π

−1
1
exp
2
det(C)

with covariance matrix :

C=

x − E (x)
y − E (y )

T

C−1

x − E (x)
y − E (y )

var(x)
cov(x, y )
cov(x, y ) var(y )

then the conditional PDF p(y |x) is also Gaussian and :
cov(x, y )
[x − E (x)]
var(x)
cov2 (x, y )
var(y |x) = var(y ) −
var(x)
E (y |x) = E (y ) +

(The Bayesian Philosophy)

Estimation Theory

Spring 2013

98 / 152

Properties of the Gaussian PDF
Example (DC level in WGN with Gaussian prior PDF)
Consider the Bayesian model x[0] = A + w [0] (just one observation) with
2
a prior PDF of A ∼ N (µA , σA ) independent of noise.
First we compute the covariance cov(A, x[0]) :
cov(A, x[0]) = E {(A − µA )(x[0] − E (x[0])}
= E {(A − µA )(A + w [0] − µA − 0)}
2
= E {(A − µA )2 + (A − µA )w [0]} = var(A) + 0 = σA

The Bayesian MMSE estimate is also Gaussian with :
σ2
cov(A, x[0])
ˆ
[x[0] − µA ] = µA + 2 A 2 (x[0] − µA )
A = µA|x = µA +
var(x)
σ + σA
2
2
ˆ
var(A) = σA|x = σA −

(The Bayesian Philosophy)

σ2
cov2 (A, x[0])
2
= σA (1 − 2 A 2 )
var(x)
σ + σA
Estimation Theory

Spring 2013

99 / 152

Properties of the Gaussian PDF
Theorem (Conditional PDF of Multivariate Gaussian)
If x (with dimension k × 1) and y (with dimension l × 1) are jointly
Gaussian with PDF :
1

p(x, y ) =
(2π)

k+l
2

exp
det(C)

with covariance matrix :

C=

−1
2
Cxx
Cyx

x − E (x)
y − E (y)

T

C−1

x − E (x)
y − E (y)

Cxy
Cyy

then the conditional PDF p(y|x) is also Gaussian and :
E (y|x) = E (y) + Cyx C−1 [x − E (x)]
xx
Cy |x

(The Bayesian Philosophy)

= Cyy − Cyx C−1 Cxy
xx

Estimation Theory

Spring 2013

100 / 152

Bayesian Linear Model
Let the data be modeled as
x = Hθ + w
where θ is a p × 1 random vector with prior PDF N (µθ , Cθ ) and w is a
noise vector with PDF N (0, Cw ).
Since θ and w are independent and Gaussian, they are jointly Gaussian
then the posterior PDF is also Gaussian. In order to ﬁnd the MMSE
estimator we should compute the covariance matrices :
Cxx

= E {[x − E (x)][x − E (x)]T }
= E {(Hθ + w − Hµθ )(Hθ + w − Hµθ )T }
= E {(H(θ − µθ ) + w)(H(θ − µθ ) + w)T }
= HE {(θ − µθ )(θ − µθ )T }HT + E (wwT ) = HCθ HT + Cw

Cθx

= E {(θ − µθ )[H(θ − µθ ) + w]T }
= E {(θ − µθ )(θ − µθ )T }HT = Cθ HT

(The Bayesian Philosophy)

Estimation Theory

Spring 2013

101 / 152

Bayesian Linear Model
Theorem (Posterior PDF for the Bayesian General Linear Model)
If the observed data can be modeled as
x = Hθ + w
where θ is a p × 1 random vector with prior PDF N (µθ , Cθ ) and w is a
noise vector with PDF N (0, Cw ), then the posterior PDF p(x|θ) is
Gaussian with mean :
E (θ|x) = µθ + Cθ HT (HCθ HT + Cw )−1 (x − Hµθ )
and covariance
Cθ|x = Cθ − Cθ HT (HCθ HT + Cw )−1 HCθ
Remark : In contrast to the classical general linear model, H need not be
full rank.
(The Bayesian Philosophy)

Estimation Theory

Spring 2013

102 / 152

Bayesian Linear Model
Example (DC Level in WGN with Gaussian Prior PDF)
x[n] = A + w [n],

n = 0, . . . , N − 1,

2
A ∼ N (µA , σA ),

w [n] ∼ N (0, σ 2 )

We have the general Bayesian linear model x = HA + w with H = 1. Then
2
2
E (A|x) = µA + σA 1T (1σA 1T + σ 2 I)−1 (x − 1µA )
2
2
2
2
var(A|x) = σA − σA 1T (1σA 1T + σ 2 I)−1 1σA

We use the Matrix Inversion Lemma to get :
(I + 1

2
σA T −1
1 ) =I−
σ2

E (A|x) = µA +
(The Bayesian Philosophy)

2
σA
2
σA +

σ2
N

11T
σ2
2
σA

+ 1T 1

=I−

11T
σ2
2
σA

+N

(¯ − µA ) and var(A|x) =
x
Estimation Theory

σ2 2
N σA
2 + σ2
σA N
Spring 2013

103 / 152

Nuisance Parameters
Deﬁnition (Nuisance Parameter)
Suppose that θ and α are unknown parameters but we are only interested
in estimating θ. In this case α is called a nuisance parameter.
In the classical approach we have to estimate both but in the
Bayesian approach we can integrate it out.
Note that in the Bayesian approach we can ﬁnd p(θ|x) from p(θ, α|x)
as a marginal PDF :
p(θ, α|x)d α

p(θ|x) =
We can also express it as
p(x|θ)p(θ)
p(θ|x) =
p(x|θ)p(θ)d θ

where

p(x|θ) =

p(x|θ, α)p(α|θ)d α

Furthermore if α is independent of θ we have :
p(x|θ) =
(The Bayesian Philosophy)

p(x|θ, α)p(α)d α

Estimation Theory

Spring 2013

104 / 152

General Bayesian Estimators

(General Bayesian Estimators)

Estimation Theory

Spring 2013

105 / 152

General Bayesian Estimators
Risk Function
A general Bayesian estimator is obtained by minimizing the Bayes Risk
ˆ
ˆ
θ = arg min R(θ)
ˆ
θ

ˆ
where R(θ) = E {C (ε)} is the Bayes Risk, C (ε) is a cost function and
ˆ
ε = θ − θ is the estimation error.

Three common risk functions
1. Quadratic :

ˆ
ˆ
R(θ) = E {ε2 } = E {(θ − θ)2 }

2. Absolute :

ˆ
ˆ
R(θ) = E {|ε|} = E {|θ − θ|}

3. Hit-or-Miss :

ˆ
R(θ) = E {C (ε)}

(General Bayesian Estimators)

where C (ε) =

Estimation Theory

0 |ε| < δ
1 |ε| ≥ δ
Spring 2013

106 / 152

General Bayesian Estimators
The Bayes risk is
ˆ
R(θ) = E {C (ε)} =
where

ˆ
g (θ) =

ˆ
C (θ − θ)p(x, θ)d xd θ =
ˆ
C (θ − θ)p(θ|x)d θ

ˆ
g (θ)p(x)dx

should be minimized.

Quadratic
ˆ
ˆ
ˆ
For this case R(θ) = E {(θ − θ)2 } =Bmse(θ) which leads to the MMSE
estimator with
ˆ
θ = E (θ|x)
ˆ
so θ is the mean of the posterior PDF p(θ|x).

(General Bayesian Estimators)

Estimation Theory

Spring 2013

107 / 152

General Bayesian Estimators
Absolute
In this case we have :
ˆ
g (θ) =

ˆ
|θ − θ|p(θ|x)d θ =

ˆ
θ
−∞

ˆ
(θ − θ)p(θ|x)d θ +

∞
ˆ
θ

ˆ
(θ − θ)p(θ|x)d θ

ˆ
By setting the derivative of g (θ) equal to zero and the use of Leibnitz’s
rule, we get :
ˆ
θ
−∞

p(θ|x)d θ =

∞
ˆ
θ

p(θ|x)d θ

ˆ
Then θ is the median (area to the left=area to the right) of p(θ|x)

(General Bayesian Estimators)

Estimation Theory

Spring 2013

108 / 152

General Bayesian Estimators
Hit-or-Miss
In this case we have
ˆ
g (θ) =

ˆ
θ−δ
−∞

= 1−

1 · p(θ|x)d θ +
ˆ
θ+δ

ˆ
θ−δ

∞
ˆ
θ+δ

1 · p(θ|x)d θ

p(θ|x)d θ

For δ arbitrarily small the optimal estimate is the location of the
maximum of p(θ|x) or the mode of the posterior PDF.
This estimator is called the maximum a posteriori (MAP) estimator.
Remark : For unimodal and symmetric posterior PDF (e.g. Gaussian
PDF), the mean and the mode and the median are the same.
(General Bayesian Estimators)

Estimation Theory

Spring 2013

109 / 152

Minimum Mean Square Error Estimators
Extension to the vector parameter case : In general, like the scalar
case, we can write :
ˆ
θi = E (θi |x) =

θi p(θi |x)d θi

i = 1, 2, . . . , p

Then p(θi |x) can be computed as a marginal conditional PDF. For
example :
ˆ
θ1 =

θ1

···

p(θ|x)d θ2 · · · d θp d θ1 =

In vector form we have :

θ1 p(θ|x)d θ
 θ2 p(θ|x)d θ
ˆ 
θ=
.
.

.

θ1 p(θ|x)d θ




=


θp(θ|x)d θ = E (θ|x)

θp p(θ|x)d θ
Similarly
(General Bayesian Estimators)

ˆ
Bmse(θi ) =

[Cθ|x ]ii p(x)d x

Estimation Theory

Spring 2013

110 / 152

Properties of MMSE Estimators
For Bayesian Linear Model, poor prior knowledge leads to MVU
estimator.
ˆ
θ = E (θ|x) = µθ + (C−1 + HT C−1 H)−1 HT C−1 (x − Hµθ )
w
w
θ
For no prior knowledge µθ → 0 and C−1 → 0, and therefore :
θ
ˆ
θ → [HT C−1 H]−1 HT C−1 x
w
w
Commutes over aﬃne transformations.
Suppose that α = Aθ + b then the MMSE estimator for α is
ˆ
α = E (α|x) = E (Aθ + b|x) = AE (θ|x) + b = Aθ + b
ˆ
Enjoys the additive property for independent data sets.
Assume that θ, x1 , x2 are jointly Gaussian with x1 and x2
independent :
ˆ
θ = E (θ) + Cθx1 C−1 1 [x1 − E (x1 )] + Cθx2 C−1 2 [x2 − E (x2 )]
x1 x
x2 x
(General Bayesian Estimators)

Estimation Theory

Spring 2013

111 / 152

Maximum A Posteriori Estimators
In the MAP estimation approach we have :
ˆ
θ = arg max p(θ|x)
θ

where
p(θ|x) =

p(x|θ)p(θ)
p(x)

An equivalent maximization is :
ˆ
θ = arg max p(x|θ)p(θ)
θ

or
ˆ
θ = arg max[ln p(x|θ) + ln p(θ)]
θ

If p(θ) is uniform or is approximately constant around the maximum
of p(x|θ) (for large data length), we can remove p(θ) to obtain the
Bayesian Maximum Likelihood :
ˆ
θ = arg max p(x|θ)
θ

(General Bayesian Estimators)

Estimation Theory

Spring 2013

112 / 152

Maximum A Posteriori Estimators
Example (DC Level in WGN with Uniform Prior PDF)
The MMSE estimator cannot be obtained in explicit form due to the need
to evaluate the following integrals :

ˆ
A=

1
2A0

A0

A
−A0

1
2A0

A0
−A0

1
−1
exp
2σ 2
(2πσ 2 )N/2

−1
1
exp
2 )N/2
2σ 2
(2πσ

N−1

(x[n] − A)2 dA

n=0
N−1

(x[n] − A)2 dA
n=0


x < −A0
¯
 −A0
ˆ
x
¯
−A0 ≤ x ≤ A0
¯
The MAP estimator is given as : A =

A0
x > A0
¯
Remark : The main advantage of MAP estimator is that for non jointly
Gaussian PDFs it may lead to explicit solutions or less computational
eﬀort.
(General Bayesian Estimators)

Estimation Theory

Spring 2013

113 / 152

Maximum A Posteriori Estimators
Extension to the vector parameter case
ˆ
θ1 = arg max p(θ1 |x) = arg max
θ1

θ1

···

p(θ|x)dθ2 . . . dθp

This needs integral evaluation of the marginal conditional PDFs.
An alternative is the following vector MAP estimator that maximizes the
joint conditional PDF :
ˆ
θ = arg max p(θ|x) = arg max p(x|θ)p(θ)
θ

θ

This corresponds to a circular Hit-or-Miss cost function.
In general, as N → ∞, the MAP estimator → the Bayesian MLE.
If the posterior PDF is Gaussian, the mode is identical to the mean,
therefore the MAP estimator is identical to the MMSE estimator.
The invariance property in ML theory does not hold for the MAP
estimator.
(General Bayesian Estimators)

Estimation Theory

Spring 2013

114 / 152

Performance Description
In the classical estimation the mean and the variance of the estimate
(or its PDF) indicates the performance of the estimator.
In the Bayesian approach the PDF of the estimate is diﬀerent for each
realization of θ. So a good estimator should perform well for every
possible value of θ.
ˆ
The estimation error ε = θ − θ is a function of two random variables
(θ and x).
The mean and the variance of the estimation error, wrt two random
variables, indicates the performance of the estimator.
The mean value of the estimation error is zero. So the estimates are
unbiased (in the Bayesian sense).
ˆ
Ex,θ (θ − θ) = Ex,θ (θ − E (θ|x)) = Ex [Eθ|x (θ) − Eθ|x (θ|x)] = Ex (0) = 0
The variance of the estimate is Bmse :
ˆ
ˆ
var(ε) = Ex,θ (ε2 ) = Ex,θ [(θ − θ)2 ] = Bmse(θ)
(General Bayesian Estimators)

Estimation Theory

Spring 2013

115 / 152

Performance Description (Vector Parameter Case)
ˆ
The vector of the estimation error is ε = θ − θ and has a zero mean.
Its covariance matrix is :
Mθ = Ex,θ (εεT ) = Ex,θ {[θ − E (θ|x)][θ − E (θ|x)]T }
ˆ
= Ex Eθ|x [θ − E (θ|x)][θ − E (θ|x)]T

= Ex (Cθ|x )

if x and θ are jointly Gaussian, we have :
Mθ = Cθ|x = Cθθ − Cθx C−1 Cxθ
ˆ
xx
since Cθ|x does not depend on x.
For a Bayesian linear model we have :
Mθ = Cθ|x = Cθ − Cθ HT (HCθ HT + Cw )−1 HCθ
ˆ
In this case ε is a linear transformation of x and θ and thus is
Gaussian. Therefore :
ε ∼ N (0, Mθ )
ˆ
(General Bayesian Estimators)

Estimation Theory

Spring 2013

116 / 152

Signal Processing Example
Deconvolution Problem : Estimate a signal transmitted through a
channel with known impulse response :
ns −1

h[n − m]s[m] + w [n]

x[n] =

n = 0, 1, . . . , N − 1

m=0

where s[n] is a WSS Gaussian process with known ACF, and w [n] is WGN
with variance σ 2 .






x[0]
x[1]
.
.
.
x[N − 1]







=







h[0]
h[1]
.
.
.
h[N − 1]

x = Hθ + w

0
h[0]
.
.
.
h[N − 2]

⇒

···
···
.
.
.
···

0
0
.
.
.
h[N − ns ]







s[0]
s[1]
.
.
.
s[ns − 1]





 
 
+
 

w [0]
w [1]
.
.
.
w [N − 1]







ˆ = Cs HT (HCs HT + σ 2 I)−1 x
s

where Cs is a symmetric Toeplitz matrix with [Cs ]ij = rss [i − j]
(General Bayesian Estimators)

Estimation Theory

Spring 2013

117 / 152

Signal Processing Example
Consider that H = I (no ﬁltering), so the Bayesian model becomes
x=s+w
Classical Approach The MVU estimator is ˆ = (HT H)−1 HT x = x.
s
Bayesian Approach The MMSE estimator is ˆ = Cs (Cs + σ 2 I)−1 x.
s
Scalar case : We estimate s[0] based on x[0] :
ˆ[0] =
s

η
rss [0]
x[0]
x[0] =
2
rss [0] + σ
η+1

where η = rss [0]/σ 2 is the SNR.
Signal is a Realization of an Auto Regressive Process : Consider
a ﬁrst order AR process : s[n] = −a s[n − 1] + u[n], where u[n] is
2
WGN with variance σu . The ACF of s is :
rss [k] =
(General Bayesian Estimators)

2
σu
(−a)|k|
1 − a2

⇒

Estimation Theory

[Cs ]ij = rss [i − j]
Spring 2013

118 / 152

Linear Bayesian Estimators

(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

119 / 152

Introduction
Problems with general Baysian estimators :
diﬃcult to determine in closed form,
need intensive computations,
involve multidimensional integration (MMSE) or multidimensional
maximization (MAP),
can be determined only under the jointly Gaussian assumption.
What can we do if the joint PDF is not Gaussian or unknown ?
Keep the MMSE criterion ;
Restrict the estimator to be linear.
This leads to the Linear MMSE Estimator :
Which is a suboptimal estimator that can be easily implemented.
It needs only the ﬁrst and second moments of the joint PDF.
It is analogous to BLUE in classical estimation.
In practice, this estimator is termed Wiener ﬁlter.
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

120 / 152

Linear MMSE Estimators (scalar case)
Goal : Estimate θ, given the data vector x. Assume that only the ﬁrst two
moments of the joint PDF of x and θ are available :
E (θ)
E (x)

,

Cθθ Cθx
Cxθ Cxx

LMMSE Estimator : Take the class of all aﬃne estimators
N−1

ˆ
θ=

an x[n] + aN = aT x + aN
n=0

where a = [a0 , a1 , . . . , aN−1 ]T . Then minimize the Bayesian MSE :
ˆ
ˆ
Bmse(θ) = E [(θ − θ)2 ]
Computing aN : Let’s diﬀerentiate the Bmse with respect to aN :
∂
E (θ − aT x − aN )2 = −2E (θ − aT x − aN )
∂aN
Setting this equal to zero gives : aN = E (θ) − aT E (x).
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

121 / 152

Linear MMSE Estimators (scalar case)
Minimize the Bayesian MSE :
ˆ
ˆ
Bmse(θ) = E [(θ − θ)2 ] = E [(θ − aT x − E (θ) + aT E (x))2 ]
= E [aT (x − E (x)) − (θ − E (θ))]2
= E [aT (x − E (x))(x − E (x))T a] − E [aT (x − E (x))(θ − E (θ))]
−E [(θ − E (θ))(x − E (x))T a] + E [(θ − E (θ))2 ]
= aT Cxx a − aT Cxθ − Cθx a + Cθθ
This can be minimized by setting the gradient to zero :
ˆ
∂Bmse(θ)
= 2Cxx a − 2Cxθ = 0
∂a
which results in a = C−1 Cxθ and leads to (Note that : Cθx = CT ) :
xx
xθ
ˆ
θ = aT x + aN = CT C−1 x + E (θ) − CT C−1 E (x)
xθ xx
xθ xx
= E (θ) + Cθx C−1 (x − E (x))
xx
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

122 / 152

Linear MMSE Estimators (scalar case)
The minimum Bayesian MSE is obtained :
ˆ
Bmse(θ) = CT C−1 Cxx C−1 Cxθ − CT C−1 Cxθ
xθ xx
xx
xθ xx
−Cθx C−1 Cxθ + Cθθ
xx

= Cθθ − Cθx C−1 Cxθ
xx
Remarks :

The results are identical to those of MMSE estimators for jointly
Gaussian PDF.
The LMMSE estimator relies on the correlation between random
variables.
If a parameter is uncorrelated with the data (but nonlinearly
dependent), it cannot be estimated with an LMMSE estimator.

(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

123 / 152

Linear MMSE Estimators (scalar case)
Example (DC Level in WGN with Uniform Prior PDF)
The data model is : x[n] = A + w [n]
n = 0, 1, . . . , N − 1
where A ∼ U [−A0 , A0 ] is independent from w [n] (WGN with variance σ 2 ).
We have E (A) = 0 and E (x) = 0. The covariances are :
Cxx

= E (xxT ) = E [(A1 + w)(A1 + w)T ] = E (A2 )11T + σ 2 I

Cθx

= E (AxT ) = E [A(A1 + w)T ] = E (A2 )1T

Therefore the LMMSE estimator is :
2
2
ˆ
A = Cθx C−1 x = σA 1T (σA 11T + σ 2 I)−1 x =
xx

where
2
σA

A0

A3
1
= E (A ) =
A
dA =
2A0
6A0
−A0

(Linear Bayesian Estimators)

2

A2 /3
0
x
¯
A2 /3 + σ 2 /N
0
A0

2

Estimation Theory

=
−A0

A2
0
3
Spring 2013

124 / 152

Linear MMSE Estimators (scalar case)
Example (DC Level in WGN with Uniform Prior PDF)
Comparison of diﬀerent Bayesian estimators :
−1
A exp
2σ 2
−A0
A0

ˆ
MMSE : A =

A0

exp
−A0

−1
2σ 2

N−1

(x[n] − A)2 dA

n=0
N−1

(x[n] − A)2 dA
n=0


x < −A0
¯
 −A0
ˆ=
x
¯
−A0 ≤ x ≤ A0
¯
MAP : A

A0
x > A0
¯
ˆ
LMMSE : A =

A2 /3
0
x
¯
A2 /3 + σ 2 /N
0

(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

125 / 152

Geometrical Interpretation
Vector space of random variables : The set of scalar zero mean random
variables is a vector space.
The zero length vector of the set is a RV with zero variance.
For any real scalar a, ax is another zero mean RV in the set.
For two RVs x and y , x + y = y + x is a RV in the set.
For two RVs x and y , the inner product is : < x, y >= E (xy )
√
The length of x is deﬁned as :
x = < x, x > = E (x 2 )
Two RVs x and y are orthogonal if :

< x, y >= E (xy ) = 0.

For RVs, x1 , x2 , y and real numbers a1 and a2 we have :
< a1 x1 + a2 x2 , y >= a1 < x1 , y > +a2 < x2 , y >
E [(a1 x1 + a2 x2 )y ] = a1 E (x1 y ) + a2 E (x2 y )
The projection of y on x is :
(Linear Bayesian Estimators)

< y, x >
E (yx)
x=
x
2
2
x
σx

Estimation Theory

Spring 2013

126 / 152

Geometrical Interpretation
The LMMSE estimator can be determined using the vector space
viewpoint. We have :
N−1

ˆ
θ=

an x[n]
n=0

where aN is zero, because of zero mean assumption.
ˆ
θ belongs to the subspace spanned by x[0], x[1], . . . , x[N − 1].
θ is not in this subspace.
A good estimator will minimize the MSE :
2
ˆ
E [(θ − θ)2 ] =
ˆ
where = θ − θ is the error vector.
Clearly the length of the vector error is minimized when is
orthogonal to the subspace spanned by x[0], x[1], . . . , x[N − 1] or to
each data sample :
ˆ
E (θ − θ)x[n] = 0
(Linear Bayesian Estimators)

for n = 0, 1, . . . , N − 1

Estimation Theory

Spring 2013

127 / 152

Geometrical Interpretation
The LMMSE estimator can be determined by solving the following
equations :
N−1

E

θ−

am x[m] x[n] = 0

n = 0, 1, . . . , N − 1

m=0

or

N−1

n = 0, 1, . . . , N − 1

am E (x[m]x[n]) = E (θx[n])






m=0
E (x 2 [0])
E (x[1]x[0])
.
.
.
E (x[N − 1]x[0])

E (x[0]x[1])
E (x 2 [1])
.
.
.
E (x[N − 1]x[1])

···
···
..
.
···

E (x[0]x[N − 1])
E (x[1]x[N − 1])
.
.
.
2 [N − 1])
E (x

Therefore
Cxx a = CT
θx

⇒



a0
a1
.
.
.






aN−1







=







E (θx[0])
E (θx[1])
.
.
.
E (θx[N − 1])







a = C−1 CT
xx θx

The LMMSE estimator is :
ˆ
θ = aT x = Cθx C−1 x
xx
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

128 / 152

The vector LMMSE Estimator
We want to estimate θ = [θ1 , θ2 , . . . , θp ]T with a linear estimator that
minimize the Bayesian MSE for each element.
N−1

ˆ
θi =

ain x[n] + aiN

ˆ
ˆ
Bmse(θi ) = E (θi − θi )2

Minimize

n=0

Therefore :
ˆ
θi = E (θi ) + Cθi x C−1 x − E (x)
xx
1×N N×N

i = 1, 2, . . . , p

N×1

The scalar LMMSE estimators can be combined into a vector estimator :
ˆ
θ = E (θ) + Cθx C−1 x − E (x)
xx
p×1

and similarly
ˆ
Bmse(θi ) = [M ˆ]ii
θ

p×N N×N

where

Mθ = Cθθ − Cθx C−1 Cxθ
ˆ
xx
p×p

(Linear Bayesian Estimators)

N×1

Estimation Theory

p×p

p×N

N×p
Spring 2013

129 / 152

The vector LMMSE Estimator
Theorem (Bayesian Gauss–Markov Theorem)
If the data are described by the Bayesian linear model form
x = Hθ + w
where θ is a p × 1 random vector with mean E (θ) and covariance Cθθ , w
is a noise vector with zero mean and covariance Cw and is uncorrelated
with θ (the joint PDF of p(θ, w) is arbitrary), then the LMMSE estimator
of θ is :
ˆ
θ = E (θ) + Cθθ HT (HCθθ HT + Cw )−1 x − HE (θ)
The performance of the estimator is measured by
zero and whose covariance matrix is

ˆ
= θ − θ whose mean is

C = Mθ = Cθθ − Cθθ HT (HCθθ HT + Cw )−1 HCθθ = C−1 + HT C−1 H
ˆ
w
θθ
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

−1

130 / 152

Sequential LMMSE Estimation
ˆ
Objective : Given θ[n − 1] based on x[n − 1], update the new estimate
ˆ based on the new sample x[n].
θ[n]

Example (DC Level in White Noise)
Assume that both A and w [n] have zero mean :
⇒

x[n] = A + w [n]
Estimator Update :

ˆ
A[N − 1] =

2
σA
x
¯
2
σA + σ 2 /N

ˆ
ˆ
ˆ
A[N] = A[N − 1] + K [N](x[N] − A[N − 1])

where

K [N] =

ˆ
Bmse(A[N − 1])
ˆ
Bmse(A[N − 1]) + σ 2

Minimum MSE Update :
ˆ
ˆ
Bmse(A[N]) = (1 − K [N])Bmse(A[N − 1])
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

131 / 152

Sequential LMMSE Estimation
Vector space view : If two observations are orthogonal, the LMMSE
estimate of θ is the sum of the projection of θ on each observation.
ˆ
1 Find the LMMSE estimator of A based on x[0], yielding A[0] :
σ2
E (Ax[0])
ˆ
x[0] = 2 A 2 x[0]
A[0] =
E (x 2 [0])
σA + σ
2

Find the LMMSE estimator of x[1] based on x[0], yielding x [1|0]
ˆ
x [1|0] =
ˆ

3

σ2
E (x[0]x[1])
x[0] = 2 A 2 x[0]
2 [0])
E (x
σA + σ

Determine the innovation of the new data :˜[1] = x[1] − x [1|0].
x
ˆ
This error vector is orthogonal to x[0]

4

ˆ
Add to A[0] the LMMSE estimator of A based on the innovation :
E (A˜[1])
x
x [1]
˜
E (˜2 [1])
x

ˆ
ˆ
A[1] = A[0] +

the projection of
(Linear Bayesian Estimators)

A

on

ˆ
= A[0] + K [1](x[1] − x [1|0])
ˆ
x [1]
˜

Estimation Theory

Spring 2013

132 / 152

Sequential LMMSE Estimation
Basic Idea : Generate a sequence of orthogonal RVs, namely, the
innovations :
x [0] ,
˜

x [1]
˜

,

x [2]
˜

,...,

x[0] x[1]−ˆ[1|0] x[2]−ˆ[2|0,1]
x
x

x [n]
˜
x[n]−ˆ[n|0,1,...,n−1]
x

Then, add the individual estimators to yield :
N

ˆ
K [n]˜[n] = A[N−1]+K [N]˜ [N]
x
x

ˆ
A[N] =

where

K [n] =

n=0

E (A˜[n])
x
E (˜2 [n])
x

It can be shown that :
ˆ
x [N] = x[N] − A[N − 1]
˜

and

K [N] =

ˆ
Bmse(A[N − 1])
ˆ
σ 2 + Bmse(A[N − 1])

the minimum MSE be updated as :
ˆ
ˆ
Bmse(A[N]) = (1 − K [N])Bmse(A[N − 1])
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

133 / 152

General Sequential LMMSE Estimation
Consider the general Bayesian linear model x = Hθ + w, where w is an
uncorrelated noise with the diagonal covariance matrix Cw . Let’s deﬁne :
2
2
2
Cw [n] = diag(σ0 , σ1 , . . . , σn )
H[n − 1]
n×p
=
H[n] =
1×p
hT [n]

x[n] =

x[0], x[1], . . . , x[n]

Estimator Update :
ˆ
ˆ
ˆ
θ[n] = θ[n − 1] + K[n] x[n] − hT [n]θ[n − 1]
where

M[n − 1]h[n]
+ hT [n]M[n − 1]h[n]
Minimum MSE Matrix Update :
K[n] =

2
σn

M[n] = (I − K[n]hT [n])M[n − 1]
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

134 / 152

General Sequential LMMSE Estimation
Remarks :
For the initialization of the sequential LMMSE estimator, we can use
the prior information :
ˆ
θ[−1] = E (θ)

M[−1] = Cθθ

For no prior knowledge about θ we can let Cθθ → ∞. Then we have
the same form as the sequential LSE, although the approaches are
fundamentally diﬀerent.
No matrix inversion is required.
The gain factor K[n] weights conﬁdence in the new data (measured
2
by σn ) against all previous data (summarized by M[n − 1]).

(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

135 / 152

Wiener Filtering
Consider the signal model : x[n] = s[n] + w [n]
n = 0, 1, . . . , N − 1
where the data and noise are zero mean with known covariance matrix.
There are three main problems concerning the Wiener Filters :
Filtering : Estimate θ = s[n] (scalar) based on the data set
x = [x[0], x[1], . . . , x[n]]. The signal sample is estimated
based on the the present and past data only.
Smoothing : Estimate θ = s = [s[0], s[1], . . . , s[N − 1]] (vector) based on
the data set x = x[0], x[1], . . . , x[N − 1] . The signal sample
is estimated based on the the present, past and future data.
Prediction : Estimate θ = x[N − 1 + ] for positive integer based on the
data set x = [x[0], x[1], . . . , x[N − 1]].
Remarks : All these problems are solved using the LMMSE estimator :
ˆ
with the minimum Bmse :
Mθ = Cθθ − Cθx C−1 Cxθ
θ = Cθx C−1 x
ˆ
xx
xx
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

136 / 152

Wiener Filtering (Smoothing)
Estimate θ = s = [s[0], s[1], . . . , s[N − 1]] (vector) based on the data set
x = x[0], x[1], . . . , x[N − 1] .
Cxx = Rxx = Rss + Rww
Therefore :

Cθx = E (sxT ) = E (s(s + w)T ) = Rss

and

ˆ = Csx C−1 x = Rss (Rss + Rww )−1 x = Wx
s
xx

Filter Interpretation : The Wiener Smoothing Matrix can be interpreted
as an FIR ﬁlter. Let’s deﬁne :
W = [a0 , a1 , . . . , aN−1 ]
where aT is the (n + 1)th raw of W. Let’s deﬁne also :
n
hn = [h(n) [0], h(1) [1], . . . , h(n) [N − 1]] which is just the vector an when
ﬂipped upside down. Then
N−1

ˆ[n] =
s

aT x
n

h(n) [N − 1 − k]x[k]

=
k=0

This represents a time-varying, non causal FIR ﬁlter.
(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

137 / 152

Wiener Filtering (Filtering)
Estimate θ = s[n] based on the data set x = x[0], x[1], . . . , x[n] . We
have again Cxx = Rxx = Rss + Rww and
Cθx = E (s[n] x[0], x[1], . . . , x[n] ) = rss [n], rss [n − 1], . . . , rss [0] = (rss )T
Therefore :

ˆ[n] = (rss )T (Rss + Rww )−1 x = aT x
s

Filter Interpretation : If we deﬁne hn = [h(n) [0], h(1) [1], . . . , h(n) [N − 1]]
which is just the vector a when ﬂipped upside down. Then :
n

h(n) [n − k]x[k]

T

ˆ[n] = a x =
s
k=0

This represents a time-varying, causal FIR ﬁlter. The impulse response can
be computed as :
(Rss + Rww )a = rss
(Linear Bayesian Estimators)

⇒
Estimation Theory

(Rss + Rww )hn = rss
Spring 2013

138 / 152

Wiener Filtering (Prediction)
Estimate θ = x[N − 1 + ] based on the data set
x = [x[0], x[1], . . . , x[N − 1]]. We have again Cxx = Rxx and
Cθx

= E (x[N − 1 + ][x[0], x[1], . . . , x[N − 1]])
=

rxx [N − 1 + ], rxx [N − 2 + ], . . . , rxx [ ] = (rxx )T

Therefore :

x [N − 1 + ] = (rxx )T R−1 x = aT x
ˆ
xx

Filter Interpretation : If we let again h[N − k] = ak , we have
N−1

h[N − k]x[k]

x [N − 1 + ] = a x =
ˆ
T

k=0

This represents a time-invariant, causal FIR ﬁlter. The impulse response
can be computed as :
Rxx h = rxx
For

= 1, this is equivalent to an Auto-Regressive process.

(Linear Bayesian Estimators)

Estimation Theory

Spring 2013

139 / 152

Kalman Filters

(Kalman Filters)

Estimation Theory

Spring 2013

140 / 152

Introduction
Kalman ﬁlter is a generalization of the Wiener ﬁlter.
In Wiener ﬁlter we estimate s[n] based on the noisy observation
vector x[n]. We assume that s[n] is a stationary random process with
known mean and covariance matrix.
In Kalman ﬁlter we assume that s[n] is a non stationary random
process whose mean and covariance matrix vary according to a known
dynamical model.
Kalman ﬁlter is a sequential MMSE estimator of s[n]. If the signal
and noise are jointly Gaussian, then the Kalman ﬁlter is an optimal
MMSE estimator, if not, it is the optimal LMMSE estimator.
Kalman ﬁlter has many applications in Control theory for state
estimation.
It can be generalized to vector signals and noise (in contrast to
Wiener ﬁlter).
(Kalman Filters)

Estimation Theory

Spring 2013

141 / 152

Dynamical Signal Models
Consider a ﬁrst order dynamical model :
s[n] = as[n − 1] + u[n]

n≥0

2
2
where u[n] is WGN with variance σu , s[−1] ∼ N (µs , σs ) and s[−1] is
independent of u[n] for all n ≥ 0. It can be shown that :
n

s[n] = a

n+1

ak u[n − k]

s[−1] +

⇒

E (s[n]) = an+1 µs

k=0

and
Cs [m, n] = E

s[m] − E (s[m]) s[n] − E (s[n])
n

2
2
= am+n+2 σs + σu am−n

a2k

for m ≥ 0

k=0

and Cs [m, n] = Cs [n, m] for m < n.
(Kalman Filters)

Estimation Theory

Spring 2013

142 / 152

Dynamical Signal Models
Theorem (Vector Gauss-Markov Model)
The Gauss-Markov model for a p × 1 vector signal s[n] is :
s[n] = As[n − 1] + Bu[n]

n≥0

A is p × p and B p × r and all eigenvalues of A are less than 1 in
magnitude. The r × 1 vector u[n] ∼ N (0, Q) and the initial condition is a
p × 1 random vector with s[n] ∼ N (µs , Cs ) and is independent of u[n]’s.
Then, the signal process is Gaussian with mean E (s[n]) = An+1 µs and
covariance :
m
m+1

Cs [m, n] = A

Cs A

n+1 T

Ak BQBT An−m+k

+

T

k=m−n

for m ≥ n and Cs [m, n] = Cs [n, m] for m < n. The covariance matrix
C[n] = Cs [n, n] and the mean and covariance propagation equations are :
E (s[n]) = AE (s[n − 1]) , C[n] = AC[n − 1]AT + BQBT
(Kalman Filters)

Estimation Theory

Spring 2013

143 / 152

Scalar Kalman Filter
Data model :
State equation
Observation equation

s[n] = as[n − 1] + u[n]
x[n] = s[n] + w [n]

Assumptions :
u[n] is zero mean Gaussian noise with independent samples and
2
E (u 2 [n]) = σu .
w [n] is zero mean Gaussian noise with independent samples and
2
E (w 2 [n]) = σn (time-varying variance).
2
s[−1] ∼ N (µs , σs ) (for simplicity we suppose that µs = 0).
s[−1], u[n] and w [n] are independent.
Objective : Develop a sequential MMSE estimator to estimate s[n] based
on the data X[n] = x[0], x[1], . . . , x[n] . This estimator is the mean of
posterior PDF :
ˆ[n|n] = E (s[n] x[0], x[1], . . . , x[n])
s
(Kalman Filters)

Estimation Theory

Spring 2013

144 / 152

Scalar Kalman Filter
To develop the equations of a Kalman ﬁlter we need the following
properties :
Property 1 : For two uncorrelated jointly Gaussian data vector, the
MMSE estimator θ (if it is zero mean) is given by :
ˆ
θ = E (θ|x1 , x2 ) = E (θ|x1 ) + E (θ|x2 )
Property 2 : If θ = θ1 + θ2 , then the MMSE estimator of θ is :
ˆ
θ = E (θ|x) = E (θ1 + θ2 |x) = E (θ1 |x) + E (θ2 |x)
Basic Idea : Generate the innovation x [n] = x[n] − x [n|n − 1] which is
˜
ˆ
uncorrelated with previous samples X[n − 1]. Then use x [n] instead of x[n]
˜
for estimation (X[n] is equivalent to X[n − 1], x [n] ).
˜

(Kalman Filters)

Estimation Theory

Spring 2013

145 / 152

Scalar Kalman Filter
From Property 1, we have :
˜
˜
ˆ[n|n] = E (s[n] X[n − 1], x [n]) = E (s[n] X[n − 1]) + E (s[n] x [n])
s
= ˆ[n|n − 1] + E (s[n] x [n])
s
˜
From Property 2, we have :
ˆ[n|n − 1] = E (as[n − 1] + u[n] X[n − 1])
s
= aE (s[n − 1] X[n − 1]) + E (u[n] X[n − 1])
= aˆ[n − 1|n − 1]
s
The MMSE estimator of s[n] based on x [n] is :
˜
E (s[n] x [n]) =
˜

E (s[n]˜(n))
x
x [n] = K [n](x[n] − x [n|n − 1])
˜
ˆ
2 [n])
E (˜
x

where x [n|n − 1] = ˆ[n|n − 1] + w[n|n − 1] = ˆ[n|n − 1].
ˆ
s
ˆ
s
Finally we have :
ˆ[n|n] = aˆ[n − 1|n − 1] + K [n](x[n] − ˆ[n|n − 1])
s
s
s
(Kalman Filters)

Estimation Theory

Spring 2013

146 / 152

Scalar State – Scalar Observation Kalman Filter
State Model :
Observation Model :

s[n] = as[n − 1] + u[n]
x[n] = s[n] + w [n]

Prediction :
ˆ[n|n − 1] = aˆ[n − 1|n − 1]
s
s
Minimum Prediction MSE :
2
M[n|n − 1] = a2 M[n − 1|n − 1] + σu

Kalman Gain :
K [n] =

2
σn

M[n|n − 1]
+ M[n|n − 1]

Correction :
ˆ[n|n] = ˆ[n|n − 1] + K [n](x[n] − ˆ[n|n − 1])
s
s
s
Minimum MSE :
M[n|n] = (1 − K [n])M[n|n − 1]
(Kalman Filters)

Estimation Theory

Spring 2013

147 / 152

Properties of Kalman Filter
The Kalman ﬁlter is an extension of the sequential MMSE estimator
but applied to time-varying parameters that are represented by a
dynamic model.
No matrix inversion is required.
The Kalman ﬁlter is a time-varying linear ﬁlter.
The Kalman ﬁlter computes (and uses) its own performance measure,
the Bayesian MSE M[n|n].
The prediction stage increases the error, while the correction stage
decreases it.
The Kalman ﬁlter generates an uncorrelated sequence from the
observations so can be viewed as a whitening ﬁlter.
The Kalman ﬁlter is optimal in the Gaussian case and the optimal
LMMSE estimator if the Gaussian assumption is not valid.
In KF M[n|n], M[n|n − 1] and K [n] do not depend on the
measurement and can be computed oﬀ line. At steady state (n → ∞)
the Kalman ﬁlter becomes an LTI ﬁlter (M[n|n], M[n|n − 1] and K [n]
become constant).
(Kalman Filters)

Estimation Theory

Spring 2013

148 / 152

Vector State – Scalar Observation Kalman Filter
State Model :
Observation Model :
Prediction :

s[n] = As[n − 1] + Bu[n] with u[n] ∼ N (0, Q)
x[n] = hT [n]s[n] + w [n] with s[−1] ∼ N (µs , Cs )
ˆ[n|n − 1] = Aˆ[n − 1|n − 1]
s
s

Minimum Prediction MSE (p × p) :
M[n|n − 1] = AM[n − 1|n − 1]AT + BQBT
Kalman Gain (p × 1) :
K[n] =

M[n|n − 1]h[n]
2
σn + hT [n]M[n|n − 1]h[n]

Correction :
ˆ[n|n] = ˆ[n|n − 1] + K[n](x[n] − hT [n]ˆ[n|n − 1])
s
s
s
Minimum MSE Matrix (p × p) :
M[n|n] = (I − K[n]hT [n])M[n|n − 1]
(Kalman Filters)

Estimation Theory

Spring 2013

149 / 152

Vector State – Vector Observation Kalman Filter
State Model :
Observation Model :
Prediction :

s[n] = As[n − 1] + Bu[n] with u[n] ∼ N (0, Q)
x[n] = H[n]s[n] + w[n] with w[n] ∼ N (0, C[n])
ˆ[n|n − 1] = Aˆ[n − 1|n − 1]
s
s

Minimum Prediction MSE (p × p) :
M[n|n − 1] = AM[n − 1|n − 1]AT + BQBT
Kalman Gain Matrix (p × M) : (Need matrix inversion !)
K[n] = M[n|n − 1]HT [n] C[n] + H[n]M[n|n − 1]HT [n]

−1

Correction :
ˆ[n|n] = ˆ[n|n − 1] + K[n](x[n] − H[n]ˆ[n|n − 1])
s
s
s
Minimum MSE Matrix (p × p) :
M[n|n] = (I − K[n]H[n])M[n|n − 1]
(Kalman Filters)

Estimation Theory

Spring 2013

150 / 152

Extended Kalman Filter
The extended Kalman ﬁlter is a sub-optimal approach when the state
and the observation equations are nonlinear.
Nonlinear data model : Consider the following nonlinear data model
s[n] = f(s[n − 1]) + Bu[n]
x[n] = g(s[n]) + w[n]
where f(·) and g(·) are nonlinear function mapping (vector to vector).
Model linearization : We linearize the model around the estimated value
of s using a ﬁrst order Taylor series.
∂f
s[n − 1] − ˆ[n − 1|n − 1]
s
f(s[n − 1]) ≈ f(ˆ[n − 1|n − 1]) +
s
∂s[n − 1]
∂g
s[n] − ˆ[n|n − 1]
s
g(s[n]) ≈ g(ˆ[n|n − 1]) +
s
∂s[n]
We denote the Jacobians by :
A[n − 1] =
(Kalman Filters)

∂f
∂s[n − 1]

H[n] =
ˆ[n−1|n−1]
s
Estimation Theory

∂g
∂s[n]

ˆ[n|n−1]
s
Spring 2013

151 / 152

Extended Kalman Filter
Now we use the linearized models :
s[n] = A[n − 1]s[n − 1] + Bu[n]
+f(ˆ[n − 1|n − 1]) − A[n − 1]ˆ[n − 1|n − 1]
s
s
x[n] = H[n]s[n] + w[n]
+g(ˆ[n|n − 1]) − H[n]ˆ[n|n − 1]
s
s
There are two diﬀerences with the standard Kalman ﬁlter :
1
2

A is now, time varying.
Both equations have known terms added to them. This will not change
the derivation of the Kalman ﬁlter.

The extended Kalman ﬁlter has exactly the same equations where A
is replaced with A[n − 1].
A[n − 1] and H[n] should be computed at each sampling time.
MSE matrices and Kalman gain can no longer be computed oﬀ line.
(Kalman Filters)

Estimation Theory

Spring 2013

152 / 152


